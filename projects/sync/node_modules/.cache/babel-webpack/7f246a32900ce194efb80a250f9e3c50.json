{"ast":null,"code":"(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('lodash'), require('circular-json')) : typeof define === 'function' && define.amd ? define(['exports', 'lodash', 'circular-json'], factory) : factory(global.TypeMoq = {}, global._, global.CircularJSON);\n})(this, function (exports, _, CircularJSON) {\n  (function (MockBehavior) {\n    MockBehavior[MockBehavior[\"Loose\"] = 0] = \"Loose\";\n    MockBehavior[MockBehavior[\"Strict\"] = 1] = \"Strict\";\n  })(exports.MockBehavior || (exports.MockBehavior = {}));\n\n  (function (ExpectedCallType) {\n    ExpectedCallType[ExpectedCallType[\"InAnyOrder\"] = 0] = \"InAnyOrder\";\n    ExpectedCallType[ExpectedCallType[\"InSequence\"] = 1] = \"InSequence\";\n  })(exports.ExpectedCallType || (exports.ExpectedCallType = {}));\n\n  var __extends$1 = undefined && undefined.__extends || function () {\n    var extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return function (d, b) {\n      extendStatics(d, b);\n\n      function __() {\n        this.constructor = d;\n      }\n\n      d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n  }();\n\n  var Exception = function (_super) {\n    __extends$1(Exception, _super);\n\n    function Exception(name, message) {\n      var _this = _super.call(this, message) || this;\n\n      _this.name = name;\n      Object.setPrototypeOf(_this, Exception.prototype);\n      return _this;\n    }\n\n    Exception.prototype.toString = function () {\n      var errMsg = this.message ? this.name + \" - \" + this.message : this.name;\n      return errMsg;\n    };\n\n    return Exception;\n  }(Error);\n\n  var __extends$2 = undefined && undefined.__extends || function () {\n    var extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return function (d, b) {\n      extendStatics(d, b);\n\n      function __() {\n        this.constructor = d;\n      }\n\n      d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n  }();\n\n  var MockExceptionReason;\n\n  (function (MockExceptionReason) {\n    MockExceptionReason[MockExceptionReason[\"NoSetup\"] = \"no setup expression found for\"] = \"NoSetup\";\n    MockExceptionReason[MockExceptionReason[\"MoreThanOneSetup\"] = \"more than one setup expression found for\"] = \"MoreThanOneSetup\";\n    MockExceptionReason[MockExceptionReason[\"InvalidArg\"] = \"invalid argument\"] = \"InvalidArg\";\n    MockExceptionReason[MockExceptionReason[\"InvalidSetup\"] = \"invalid setup expression\"] = \"InvalidSetup\";\n    MockExceptionReason[MockExceptionReason[\"InvalidMatcher\"] = \"invalid matching expression\"] = \"InvalidMatcher\";\n    MockExceptionReason[MockExceptionReason[\"UnknownGlobalType\"] = \"unknown global type\"] = \"UnknownGlobalType\";\n    MockExceptionReason[MockExceptionReason[\"CallCountVerificationFailed\"] = \"invocation count verification failed\"] = \"CallCountVerificationFailed\";\n    MockExceptionReason[MockExceptionReason[\"CallOrderVerificationFailed\"] = \"invocation order verification failed\"] = \"CallOrderVerificationFailed\";\n    MockExceptionReason[MockExceptionReason[\"InvalidDynamicProxyRuntime\"] = \"invalid dynamic proxy runtime\"] = \"InvalidDynamicProxyRuntime\";\n  })(MockExceptionReason || (MockExceptionReason = {}));\n\n  var MockException = function (_super) {\n    __extends$2(MockException, _super);\n\n    function MockException(reason, ctx, message) {\n      if (message === void 0) {\n        message = undefined;\n      }\n\n      var _this = _super.call(this, \"MockException\", message) || this;\n\n      _this.reason = reason;\n      _this.ctx = ctx;\n      _this.message = message;\n      Object.setPrototypeOf(_this, MockException.prototype);\n      return _this;\n    }\n\n    MockException.prototype.toString = function () {\n      var errMsg = this.name + \" - \" + this.reason;\n      if (this.message) errMsg = errMsg + \" (\" + this.message + \")\";\n      return errMsg;\n    };\n\n    return MockException;\n  }(Exception);\n\n  var Times = function () {\n    function Times(_condition, min, max, failMessage) {\n      this._condition = _condition;\n      this.min = min;\n      this.max = max;\n      this._failMessage = _.template(failMessage);\n    }\n\n    Times.prototype.failMessage = function (call) {\n      return this._failMessage({\n        i: call,\n        min: this.min,\n        max: this.max,\n        c: this._lastCallCount\n      });\n    };\n\n    Times.prototype.verify = function (callCount) {\n      this._lastCallCount = callCount;\n      return this._condition(callCount);\n    };\n\n    Times.checkArg = function (n, target) {\n      if (n < 0) throw new MockException(MockExceptionReason.InvalidArg, undefined, target + \" argument cannot be a negative number\");\n    };\n\n    Times.exactly = function (n) {\n      Times.checkArg(n, \"'Times.exactly'\");\n      return new Times(function (c) {\n        return c === n;\n      }, n, n, Times.NO_MATCHING_CALLS_EXACTLY_N_TIMES);\n    };\n\n    Times.atLeast = function (n) {\n      Times.checkArg(n, \"'Times.atLeast'\");\n      return new Times(function (c) {\n        return c >= n;\n      }, n, 255, Times.NO_MATCHING_CALLS_AT_LEAST_N_TIMES);\n    };\n\n    Times.atMost = function (n) {\n      Times.checkArg(n, \"'Times.atMost'\");\n      return new Times(function (c) {\n        return c >= 0 && c <= n;\n      }, 0, n, Times.NO_MATCHING_CALLS_AT_MOST_N_TIMES);\n    };\n\n    Times.never = function () {\n      return Times.exactly(0);\n    };\n\n    Times.once = function () {\n      return Times.exactly(1);\n    };\n\n    Times.atLeastOnce = function () {\n      return Times.atLeast(1);\n    };\n\n    Times.atMostOnce = function () {\n      return Times.atMost(1);\n    };\n\n    Times.prototype.toString = function () {\n      var res = \"\";\n\n      if (this.min === this.max) {\n        if (this.min === 0) {\n          res = \"never\";\n        } else if (this.min === 1) {\n          res = \"once\";\n        } else {\n          res = this.min + \" times\";\n        }\n      } else {\n        if (this.min === 0 && this.max !== 255) res = \"at most \" + this.max + \" times\";else res = \"at least \" + this.min + \" times\";\n      }\n\n      return res;\n    };\n\n    Times.NO_MATCHING_CALLS_EXACTLY_N_TIMES = \"expected invocation of <%= i %> exactly <%= min %> times, invoked <%= c %> times\";\n    Times.NO_MATCHING_CALLS_AT_LEAST_N_TIMES = \"expected invocation of <%= i %> at least <%= min %> times, invoked <%= c %> times\";\n    Times.NO_MATCHING_CALLS_AT_MOST_N_TIMES = \"expected invocation of <%= i %> at most <%= max %> times, invoked <%= c %> times\";\n    return Times;\n  }();\n\n  var PropertyRetriever = function () {\n    function PropertyRetriever() {}\n\n    PropertyRetriever.getOwnEnumerables = function (obj) {\n      return this._getPropertyNames(obj, true, false, this._enumerable);\n    };\n\n    PropertyRetriever.getOwnNonenumerables = function (obj) {\n      return this._getPropertyNames(obj, true, false, this._notEnumerable);\n    };\n\n    PropertyRetriever.getOwnEnumerablesAndNonenumerables = function (obj) {\n      return this._getPropertyNames(obj, true, false, this._enumerableAndNotEnumerable);\n    };\n\n    PropertyRetriever.getPrototypeEnumerables = function (obj) {\n      return this._getPropertyNames(obj, false, true, this._enumerable);\n    };\n\n    PropertyRetriever.getPrototypeNonenumerables = function (obj) {\n      return this._getPropertyNames(obj, false, true, this._notEnumerable);\n    };\n\n    PropertyRetriever.getPrototypeEnumerablesAndNonenumerables = function (obj) {\n      return this._getPropertyNames(obj, false, true, this._enumerableAndNotEnumerable);\n    };\n\n    PropertyRetriever.getOwnAndPrototypeEnumerables = function (obj) {\n      return this._getPropertyNames(obj, true, true, this._enumerable);\n    };\n\n    PropertyRetriever.getOwnAndPrototypeNonenumerables = function (obj) {\n      return this._getPropertyNames(obj, true, true, this._notEnumerable);\n    };\n\n    PropertyRetriever.getOwnAndPrototypeEnumerablesAndNonenumerables = function (obj) {\n      return this._getPropertyNames(obj, true, true, this._enumerableAndNotEnumerable);\n    };\n\n    PropertyRetriever._enumerable = function (obj, prop) {\n      return obj.propertyIsEnumerable(prop);\n    };\n\n    PropertyRetriever._notEnumerable = function (obj, prop) {\n      return !obj.propertyIsEnumerable(prop);\n    };\n\n    PropertyRetriever._enumerableAndNotEnumerable = function (obj, prop) {\n      return true;\n    };\n\n    PropertyRetriever._getPropertyNames = function (obj, iterateSelfBool, iteratePrototypeBool, includePropCb) {\n      var result = [];\n\n      do {\n        if (iterateSelfBool) {\n          var props = Object.getOwnPropertyNames(obj);\n\n          var _loop_1 = function _loop_1(prop) {\n            var duplicate = _.find(result, function (p) {\n              return p.name === prop;\n            });\n\n            if (!duplicate && includePropCb(obj, prop)) {\n              var propDesc = Object.getOwnPropertyDescriptor(obj, prop);\n              result.push({\n                name: prop,\n                desc: propDesc\n              });\n            }\n          };\n\n          for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {\n            var prop = props_1[_i];\n\n            _loop_1(prop);\n          }\n        }\n\n        if (!iteratePrototypeBool) {\n          break;\n        }\n\n        iterateSelfBool = true;\n      } while (obj = Object.getPrototypeOf(obj));\n\n      return result;\n    };\n\n    return PropertyRetriever;\n  }();\n\n  var Consts = function () {\n    function Consts() {}\n\n    Consts.IMATCH_ID_VALUE = \"438A51D3-6864-49D7-A655-CA1153B86965\";\n    Consts.IMATCH_ID_NAME = \"___id\";\n    Consts.IMATCH_MATCHES_NAME = \"___matches\";\n    Consts.IPROXY_ID_VALUE = \"BCDF5CE5-F0DF-40B7-8BA0-69DF395033C8\";\n    Consts.IPROXY_ID_NAME = \"___id\";\n    return Consts;\n  }();\n\n  var Match = function () {\n    function Match() {}\n\n    Match.isMatcher = function (x) {\n      return !_.isNil(x) && !_.isUndefined(x[Consts.IMATCH_MATCHES_NAME]) && !_.isUndefined(x[Consts.IMATCH_ID_NAME]) && x[Consts.IMATCH_ID_NAME] === Consts.IMATCH_ID_VALUE;\n    };\n\n    return Match;\n  }();\n\n  var Utils = function () {\n    function Utils() {}\n\n    Utils.functionName = function (fun) {\n      var res;\n\n      if (fun.name) {\n        res = fun.name;\n      } else {\n        var repr = fun.toString();\n        repr = repr.substr(\"function \".length);\n        res = repr.substr(0, repr.indexOf(\"(\"));\n      }\n\n      return res;\n    };\n\n    Utils.objectName = function (obj) {\n      var res = Utils.functionName(obj.constructor);\n      return res;\n    };\n\n    Utils.argsName = function (args) {\n      var argsArray = Array.prototype.slice.call(args);\n      var sargs = argsArray.map(function (x) {\n        var res = \"\";\n\n        if (Match.isMatcher(x)) {\n          res = x.toString();\n        } else {\n          var replacer = function replacer(key, value) {\n            if (value === undefined) return \"undefined\";\n            if (_.isFunction(value)) return \"Function\";\n            return value;\n          };\n\n          res = CircularJSON.stringify(x, replacer);\n        }\n\n        return res;\n      });\n\n      var res = _.join(sargs);\n\n      return res;\n    };\n\n    Utils.conthunktor = function (ctor, args) {\n      var ret = new (ctor.bind.apply(ctor, [void 0].concat(args)))();\n      return ret;\n    };\n\n    Utils.clone = function (target, source) {\n      var sourceProps = PropertyRetriever.getOwnAndPrototypeEnumerablesAndNonenumerables(source);\n\n      for (var _i = 0, sourceProps_1 = sourceProps; _i < sourceProps_1.length; _i++) {\n        var p = sourceProps_1[_i];\n        Object.defineProperty(target, p.name, p.desc);\n      }\n    };\n\n    return Utils;\n  }();\n\n  var MatchAnyObject = function () {\n    function MatchAnyObject(_ctor) {\n      this._ctor = _ctor;\n      this.___id = Consts.IMATCH_ID_VALUE;\n    }\n\n    MatchAnyObject.prototype.___matches = function (object) {\n      var match = false;\n      if (object && object.constructor.prototype == this._ctor.prototype) match = true;\n      return match;\n    };\n\n    MatchAnyObject.prototype.toString = function () {\n      var res = \"It.isAnyObject(\" + Utils.functionName(this._ctor) + \")\";\n      return res;\n    };\n\n    return MatchAnyObject;\n  }();\n\n  var MatchAny = function () {\n    function MatchAny() {\n      this.___id = Consts.IMATCH_ID_VALUE;\n    }\n\n    MatchAny.prototype.___matches = function (object) {\n      var match = true;\n      return match;\n    };\n\n    MatchAny.prototype.toString = function () {\n      return \"It.isAny()\";\n    };\n\n    return MatchAny;\n  }();\n\n  var MatchAnyString = function () {\n    function MatchAnyString() {\n      this.___id = Consts.IMATCH_ID_VALUE;\n    }\n\n    MatchAnyString.prototype.___matches = function (object) {\n      var match = false;\n      if (_.isString(object)) match = true;\n      return match;\n    };\n\n    MatchAnyString.prototype.toString = function () {\n      return \"It.isAnyString()\";\n    };\n\n    return MatchAnyString;\n  }();\n\n  var MatchAnyNumber = function () {\n    function MatchAnyNumber() {\n      this.___id = Consts.IMATCH_ID_VALUE;\n    }\n\n    MatchAnyNumber.prototype.___matches = function (object) {\n      var match = false;\n      if (_.isNumber(object)) match = true;\n      return match;\n    };\n\n    MatchAnyNumber.prototype.toString = function () {\n      return \"It.isAnyNumber()\";\n    };\n\n    return MatchAnyNumber;\n  }();\n\n  var MatchPred = function () {\n    function MatchPred(_pred) {\n      this._pred = _pred;\n      this.___id = Consts.IMATCH_ID_VALUE;\n    }\n\n    MatchPred.prototype.___matches = function (object) {\n      var match = false;\n      if (object && this._pred(object)) match = true;\n      return match;\n    };\n\n    MatchPred.prototype.toString = function () {\n      var res = \"It.is(\" + this._pred + \")\";\n      return res;\n    };\n\n    return MatchPred;\n  }();\n\n  var MatchValue = function () {\n    function MatchValue(value) {\n      this.___id = Consts.IMATCH_ID_VALUE;\n      this._value = _.cloneDeep(value);\n    }\n\n    MatchValue.prototype.___matches = function (object) {\n      var match = false;\n      if (_.isEqual(this._value, object)) match = true;\n      return match;\n    };\n\n    MatchValue.prototype.toString = function () {\n      var valueName = Utils.argsName([this._value]);\n      var res = \"It.isValue(\" + valueName + \")\";\n      return res;\n    };\n\n    return MatchValue;\n  }();\n\n  var MatchObjectWith = function () {\n    function MatchObjectWith(value) {\n      this.___id = Consts.IMATCH_ID_VALUE;\n      this._value = _.cloneDeep(value);\n    }\n\n    MatchObjectWith.prototype.___matches = function (object) {\n      var match = false;\n\n      var partial = _.pick(object, _.keys(this._value));\n\n      if (_.isEqual(this._value, partial)) match = true;\n      return match;\n    };\n\n    MatchObjectWith.prototype.toString = function () {\n      var valueName = Utils.argsName([this._value]);\n      var res = \"It.isObjectWith(\" + valueName + \")\";\n      return res;\n    };\n\n    return MatchObjectWith;\n  }();\n\n  var CallType;\n\n  (function (CallType) {\n    CallType[CallType[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n    CallType[CallType[\"PROPERTY\"] = 1] = \"PROPERTY\";\n    CallType[CallType[\"FUNCTION\"] = 2] = \"FUNCTION\";\n  })(CallType || (CallType = {}));\n\n  var ProxyType;\n\n  (function (ProxyType) {\n    ProxyType[ProxyType[\"STATIC\"] = 0] = \"STATIC\";\n    ProxyType[ProxyType[\"DYNAMIC\"] = 1] = \"DYNAMIC\";\n  })(ProxyType || (ProxyType = {}));\n\n  var __extends$3 = undefined && undefined.__extends || function () {\n    var extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return function (d, b) {\n      extendStatics(d, b);\n\n      function __() {\n        this.constructor = d;\n      }\n\n      d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n  }();\n\n  var InvocationType;\n\n  (function (InvocationType) {\n    InvocationType[InvocationType[\"NONE\"] = 0] = \"NONE\";\n    InvocationType[InvocationType[\"SETUP\"] = 1] = \"SETUP\";\n    InvocationType[InvocationType[\"EXECUTE\"] = 2] = \"EXECUTE\";\n  })(InvocationType || (InvocationType = {}));\n\n  var BaseInvocation = function () {\n    function BaseInvocation(proxyType, callType) {\n      this.proxyType = proxyType;\n      this.callType = callType;\n      this.invocationType = InvocationType.NONE;\n    }\n\n    Object.defineProperty(BaseInvocation.prototype, \"isAnUnknownDynamicCallAtExecution\", {\n      get: function get() {\n        return this.proxyType == ProxyType.DYNAMIC && this.callType == CallType.UNKNOWN && this.invocationType == InvocationType.EXECUTE;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    return BaseInvocation;\n  }();\n\n  var MethodInvocation = function (_super) {\n    __extends$3(MethodInvocation, _super);\n\n    function MethodInvocation(_that, _property, args, proxyType, callType) {\n      if (proxyType === void 0) {\n        proxyType = ProxyType.STATIC;\n      }\n\n      if (callType === void 0) {\n        callType = CallType.FUNCTION;\n      }\n\n      var _this = _super.call(this, proxyType, callType) || this;\n\n      _this._that = _that;\n      _this._property = _property;\n\n      if (args) {\n        _this._args = _.cloneDeep(args);\n        _this._args.length = args.length;\n        _this._args.callee = args.callee;\n      }\n\n      return _this;\n    }\n\n    Object.defineProperty(MethodInvocation.prototype, \"args\", {\n      get: function get() {\n        return this._args || {\n          length: 0,\n          callee: null\n        };\n      },\n      set: function set(value) {\n        this._args = value;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(MethodInvocation.prototype, \"property\", {\n      get: function get() {\n        return this._property;\n      },\n      enumerable: true,\n      configurable: true\n    });\n\n    MethodInvocation.prototype.invokeBase = function () {\n      var thatClone = {};\n      if (this._that) Utils.clone(thatClone, this._that);else thatClone = this._property.obj;\n      this.returnValue = this._property.toFunc.apply(thatClone, this._args);\n    };\n\n    MethodInvocation.prototype.toString = function () {\n      var res = this.property + \"(\" + Utils.argsName(this.args) + \")\";\n      return res;\n    };\n\n    return MethodInvocation;\n  }(BaseInvocation);\n\n  var ValueGetterInvocation = function (_super) {\n    __extends$3(ValueGetterInvocation, _super);\n\n    function ValueGetterInvocation(_property, value, proxyType, callType) {\n      if (proxyType === void 0) {\n        proxyType = ProxyType.STATIC;\n      }\n\n      if (callType === void 0) {\n        callType = CallType.PROPERTY;\n      }\n\n      var _this = _super.call(this, proxyType, callType) || this;\n\n      _this._property = _property;\n      _this.value = value;\n      _this.returnValue = _.cloneDeep(value);\n      return _this;\n    }\n\n    Object.defineProperty(ValueGetterInvocation.prototype, \"args\", {\n      get: function get() {\n        var args = [];\n        Object.defineProperty(args, \"callee\", {\n          configurable: true,\n          enumerable: true,\n          writable: false,\n          value: null\n        });\n        return args;\n      },\n      set: function set(value) {},\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(ValueGetterInvocation.prototype, \"property\", {\n      get: function get() {\n        return this._property;\n      },\n      enumerable: true,\n      configurable: true\n    });\n\n    ValueGetterInvocation.prototype.invokeBase = function () {\n      this.returnValue = this._property.obj[this._property.name];\n    };\n\n    ValueGetterInvocation.prototype.toString = function () {\n      var res = \"\" + this.property;\n      return res;\n    };\n\n    return ValueGetterInvocation;\n  }(BaseInvocation);\n\n  var DynamicGetInvocation = function (_super) {\n    __extends$3(DynamicGetInvocation, _super);\n\n    function DynamicGetInvocation(property, value) {\n      var _this = _super.call(this, property, value, ProxyType.DYNAMIC, CallType.UNKNOWN) || this;\n\n      _this.returnValue = _.cloneDeep(value);\n      return _this;\n    }\n\n    return DynamicGetInvocation;\n  }(ValueGetterInvocation);\n\n  var ValueSetterInvocation = function (_super) {\n    __extends$3(ValueSetterInvocation, _super);\n\n    function ValueSetterInvocation(_property, args, proxyType, callType) {\n      if (proxyType === void 0) {\n        proxyType = ProxyType.STATIC;\n      }\n\n      if (callType === void 0) {\n        callType = CallType.PROPERTY;\n      }\n\n      var _this = _super.call(this, proxyType, callType) || this;\n\n      _this._property = _property;\n      _this._args = _.cloneDeep(args);\n      _this._args.length = args.length;\n      _this._args.callee = args.callee;\n      return _this;\n    }\n\n    Object.defineProperty(ValueSetterInvocation.prototype, \"args\", {\n      get: function get() {\n        return this._args;\n      },\n      set: function set(value) {\n        this._args = value;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(ValueSetterInvocation.prototype, \"property\", {\n      get: function get() {\n        return this._property;\n      },\n      enumerable: true,\n      configurable: true\n    });\n\n    ValueSetterInvocation.prototype.invokeBase = function () {\n      this._property.obj[this._property.name] = this._args[0];\n      this.returnValue = this._property.obj[this._property.name];\n    };\n\n    ValueSetterInvocation.prototype.toString = function () {\n      var res = this.property + \" = \" + Utils.argsName(this.args[0]);\n      return res;\n    };\n\n    return ValueSetterInvocation;\n  }(BaseInvocation);\n\n  var MethodGetterInvocation = function (_super) {\n    __extends$3(MethodGetterInvocation, _super);\n\n    function MethodGetterInvocation(_property, _getter, proxyType, callType) {\n      if (proxyType === void 0) {\n        proxyType = ProxyType.STATIC;\n      }\n\n      if (callType === void 0) {\n        callType = CallType.FUNCTION;\n      }\n\n      var _this = _super.call(this, proxyType, callType) || this;\n\n      _this._property = _property;\n      _this._getter = _getter;\n      return _this;\n    }\n\n    Object.defineProperty(MethodGetterInvocation.prototype, \"args\", {\n      get: function get() {\n        var args = [];\n        Object.defineProperty(args, \"callee\", {\n          configurable: true,\n          enumerable: true,\n          writable: false,\n          value: null\n        });\n        return args;\n      },\n      set: function set(value) {},\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(MethodGetterInvocation.prototype, \"property\", {\n      get: function get() {\n        return this._property;\n      },\n      enumerable: true,\n      configurable: true\n    });\n\n    MethodGetterInvocation.prototype.invokeBase = function () {\n      this.returnValue = this._property.obj[this._property.name];\n    };\n\n    MethodGetterInvocation.prototype.toString = function () {\n      var res = \"\" + this.property;\n      return res;\n    };\n\n    return MethodGetterInvocation;\n  }(BaseInvocation);\n\n  var MethodSetterInvocation = function (_super) {\n    __extends$3(MethodSetterInvocation, _super);\n\n    function MethodSetterInvocation(_property, _setter, args, proxyType, callType) {\n      if (proxyType === void 0) {\n        proxyType = ProxyType.STATIC;\n      }\n\n      if (callType === void 0) {\n        callType = CallType.FUNCTION;\n      }\n\n      var _this = _super.call(this, proxyType, callType) || this;\n\n      _this._property = _property;\n      _this._setter = _setter;\n      _this._args = _.cloneDeep(args);\n      _this._args.length = args.length;\n      _this._args.callee = args.callee;\n      return _this;\n    }\n\n    Object.defineProperty(MethodSetterInvocation.prototype, \"args\", {\n      get: function get() {\n        return this._args;\n      },\n      set: function set(value) {\n        this._args = value;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(MethodSetterInvocation.prototype, \"property\", {\n      get: function get() {\n        return this._property;\n      },\n      enumerable: true,\n      configurable: true\n    });\n\n    MethodSetterInvocation.prototype.invokeBase = function () {\n      this._property.obj[this._property.name] = this._args[0];\n      this.returnValue = this._property.obj[this._property.name];\n    };\n\n    MethodSetterInvocation.prototype.toString = function () {\n      var res = this.property + \"(\" + Utils.argsName(this.args[0]) + \")\";\n      return res;\n    };\n\n    return MethodSetterInvocation;\n  }(BaseInvocation);\n\n  var MethodInfo = function () {\n    function MethodInfo(obj, name, desc) {\n      this.obj = obj;\n      this.name = name;\n      if (desc) this.desc = _.cloneDeep(desc);\n    }\n\n    Object.defineProperty(MethodInfo.prototype, \"toFunc\", {\n      get: function get() {\n        var func = _.isFunction(this.obj) ? this.obj : this.obj[this.name];\n        return func;\n      },\n      enumerable: true,\n      configurable: true\n    });\n\n    MethodInfo.prototype.toString = function () {\n      var objName = Utils.objectName(this.obj);\n      var res = _.isFunction(this.obj) ? \"\" + objName : objName + \".\" + this.name;\n      return res;\n    };\n\n    return MethodInfo;\n  }();\n\n  var PropertyInfo = function () {\n    function PropertyInfo(obj, name, desc) {\n      this.obj = obj;\n      this.name = name;\n      if (desc) this.desc = _.cloneDeep(desc);\n    }\n\n    PropertyInfo.prototype.toString = function () {\n      var objName = Utils.objectName(this.obj);\n      var res = objName + \".\" + this.name;\n      return res;\n    };\n\n    return PropertyInfo;\n  }();\n\n  var ProxyES5 = function () {\n    function ProxyES5(target, interceptor) {\n      var _this = this;\n\n      this.___id = Consts.IPROXY_ID_VALUE;\n      this.check(target);\n      var that = this;\n      var props = PropertyRetriever.getOwnAndPrototypeEnumerablesAndNonenumerables(target);\n\n      _.each(props, function (prop) {\n        if (_.isFunction(prop.desc.value)) {\n          var propDesc = {\n            configurable: prop.desc.configurable,\n            enumerable: prop.desc.enumerable,\n            writable: prop.desc.writable\n          };\n\n          _this.defineMethodProxy(that, interceptor, target, prop.name, propDesc);\n        } else {\n          var propDesc = {\n            configurable: prop.desc.configurable,\n            enumerable: prop.desc.enumerable\n          };\n          if (prop.desc.value !== undefined) _this.defineValuePropertyProxy(that, interceptor, target, prop.name, prop.desc.value, propDesc);else _this.defineGetSetPropertyProxy(that, interceptor, target, prop.name, prop.desc.get, prop.desc.set, propDesc);\n        }\n      });\n    }\n\n    ProxyES5.of = function (target, interceptor) {\n      ProxyES5.check(target);\n      var result;\n\n      if (_.isFunction(target)) {\n        var funcName = Utils.functionName(target);\n        result = ProxyES5.methodProxyValue(undefined, interceptor, target, funcName, null);\n      } else {\n        result = new ProxyES5(target, interceptor);\n      }\n\n      return result;\n    };\n\n    ProxyES5.isProxy = function (obj) {\n      if (!_.isNil(obj) && !_.isUndefined(obj[Consts.IPROXY_ID_NAME]) && obj[Consts.IPROXY_ID_NAME] === Consts.IPROXY_ID_VALUE) return true;else return false;\n    };\n\n    ProxyES5.check = function (target) {\n      ProxyES5.checkNotNullOrUndefined(target);\n      var ok = false;\n      if (_.isFunction(target) || _.isObject(target) && !ProxyES5.isPrimitiveObject(target)) ok = true;\n      if (!ok) throw new MockException(MockExceptionReason.InvalidArg, target, \"'\" + target + \"'; proxy argument should be a function or a non primitive object\");\n    };\n\n    ProxyES5.prototype.check = function (target) {\n      ProxyES5.checkNotNullOrUndefined(target);\n      var ok = false;\n      if (!_.isFunction(target) && _.isObject(target) && !ProxyES5.isPrimitiveObject(target)) ok = true;\n      if (!ok) throw new MockException(MockExceptionReason.InvalidArg, target, \"'\" + target + \"'; proxy argument should be a non primitive object\");\n    };\n\n    ProxyES5.checkNotNullOrUndefined = function (instance) {\n      if (_.isNil(instance)) throw new MockException(MockExceptionReason.InvalidArg, instance, \"'\" + instance + \"'; proxy argument is required\");\n    };\n\n    ProxyES5.isPrimitiveObject = function (obj) {\n      var result = false;\n      if (_.isFunction(obj) || _.isArray(obj) || _.isDate(obj) || _.isNull(obj)) result = true;\n      return result;\n    };\n\n    ProxyES5.prototype.defineMethodProxy = function (that, interceptor, target, propName, propDesc) {\n      if (propDesc === void 0) {\n        propDesc = {\n          configurable: true,\n          enumerable: true,\n          writable: false\n        };\n      }\n\n      propDesc.value = ProxyES5.methodProxyValue(that, interceptor, target, propName, propDesc);\n      this.defineProperty(that, propName, propDesc);\n    };\n\n    ProxyES5.methodProxyValue = function (that, interceptor, target, propName, propDesc) {\n      function proxy() {\n        var method = new MethodInfo(target, propName, propDesc);\n        var invocation = new MethodInvocation(that, method, arguments);\n        interceptor.intercept(invocation);\n        return invocation.returnValue;\n      }\n\n      return proxy;\n    };\n\n    ProxyES5.prototype.defineValuePropertyProxy = function (that, interceptor, target, propName, propValue, propDesc) {\n      if (propDesc === void 0) {\n        propDesc = {\n          configurable: true,\n          enumerable: true\n        };\n      }\n\n      function getProxy() {\n        var method = new PropertyInfo(target, propName);\n        var invocation = new ValueGetterInvocation(method, propValue);\n        interceptor.intercept(invocation);\n        return invocation.returnValue;\n      }\n\n      propDesc.get = getProxy;\n\n      function setProxy(v) {\n        var method = new PropertyInfo(target, propName);\n        var invocation = new ValueSetterInvocation(method, arguments);\n        interceptor.intercept(invocation);\n      }\n\n      propDesc.set = setProxy;\n      this.defineProperty(that, propName, propDesc);\n    };\n\n    ProxyES5.prototype.defineGetSetPropertyProxy = function (that, interceptor, target, propName, get, set, propDesc) {\n      if (propDesc === void 0) {\n        propDesc = {\n          configurable: true,\n          enumerable: true\n        };\n      }\n\n      function getProxy() {\n        var method = new PropertyInfo(target, propName);\n        var invocation = new MethodGetterInvocation(method, get);\n        interceptor.intercept(invocation);\n        return invocation.returnValue;\n      }\n\n      propDesc.get = getProxy;\n\n      function setProxy(v) {\n        var method = new PropertyInfo(target, propName);\n        var invocation = new MethodSetterInvocation(method, set, arguments);\n        interceptor.intercept(invocation);\n      }\n\n      propDesc.set = setProxy;\n      this.defineProperty(that, propName, propDesc);\n    };\n\n    ProxyES5.prototype.defineProperty = function (obj, name, desc) {\n      try {\n        Object.defineProperty(obj, name, desc);\n      } catch (e) {\n        console.log(e.message);\n      }\n    };\n\n    return ProxyES5;\n  }();\n\n  var ProxyES6 = function () {\n    function ProxyES6(target, handler) {\n      this.___id = Consts.IPROXY_ID_VALUE;\n      var p = new Proxy(target, handler);\n      p[Symbol.toStringTag] = Function.prototype.toString.bind(target);\n      return p;\n    }\n\n    ProxyES6.of = function (target, handler) {\n      ProxyES6.check();\n      var result = new ProxyES6(target, handler);\n      return result;\n    };\n\n    ProxyES6.check = function () {\n      if (typeof Proxy === \"undefined\") throw new MockException(MockExceptionReason.InvalidDynamicProxyRuntime, null, \"ES6 Proxy object not detected; the dynamic mocking feature requires ES6 Proxy object support\");\n    };\n\n    return ProxyES6;\n  }();\n\n  var ProxyES6Handler = function () {\n    function ProxyES6Handler(_interceptor) {\n      this._interceptor = _interceptor;\n    }\n\n    ProxyES6Handler.prototype.apply = function (target, thisArg, argArray) {\n      var funcName = Utils.functionName(target);\n      var method = new MethodInfo(target, funcName);\n      var invocation = new MethodInvocation(target, method, argArray, ProxyType.DYNAMIC);\n\n      this._interceptor.intercept(invocation);\n\n      return invocation.returnValue;\n    };\n\n    ProxyES6Handler.prototype.get = function (target, p, receiver) {\n      var _this = this;\n\n      if (p !== Symbol.toStringTag && p !== Symbol.toPrimitive && p !== \"toJSON\") {\n        var propValue = target[p];\n        var method = new PropertyInfo(target, p);\n        var invocation_1 = new DynamicGetInvocation(method, propValue);\n\n        this._interceptor.intercept(invocation_1);\n\n        if (invocation_1.callType == CallType.PROPERTY && invocation_1.property.desc) return invocation_1.returnValue;else return function () {\n          var args = [];\n\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n\n          _this._interceptor.removeInvocation(invocation_1);\n\n          var method = new MethodInfo(target, p);\n          var methodInvocation = new MethodInvocation(target, method, args, ProxyType.DYNAMIC);\n\n          _this._interceptor.intercept(methodInvocation);\n\n          return methodInvocation.returnValue;\n        };\n      } else return Reflect.get(target, p, receiver);\n    };\n\n    ProxyES6Handler.prototype.set = function (target, p, value, receiver) {\n      if (p !== Symbol.toStringTag) {\n        var method = new PropertyInfo(target, p);\n        var invocation = new ValueSetterInvocation(method, [value], ProxyType.DYNAMIC);\n\n        this._interceptor.intercept(invocation);\n      }\n\n      return Reflect.set(target, p, value, receiver);\n    };\n\n    ProxyES6Handler.prototype.defineProperty = function (target, p, attributes) {\n      attributes.configurable = true;\n      return Reflect.defineProperty(target, p, attributes);\n    };\n\n    return ProxyES6Handler;\n  }();\n\n  var ProxyFactory = function () {\n    function ProxyFactory() {}\n\n    ProxyFactory.createProxy = function (target, interceptor) {\n      var proxy = ProxyES5.of(target, interceptor);\n      return proxy;\n    };\n\n    ProxyFactory.createProxyES6 = function (target, interceptor) {\n      var proxyHandler = new ProxyES6Handler(interceptor);\n      var proxy = ProxyES6.of(target, proxyHandler);\n      return proxy;\n    };\n\n    return ProxyFactory;\n  }();\n\n  var MockBase = function () {\n    function MockBase(target, canOverrideTarget, behavior) {\n      if (behavior === void 0) {\n        behavior = exports.MockBehavior.Loose;\n      }\n\n      this.target = target;\n      this.canOverrideTarget = canOverrideTarget;\n      this.behavior = behavior;\n      this._id = this.generateId();\n      this._name = this.getNameOf(this.target);\n    }\n\n    Object.defineProperty(MockBase.prototype, \"object\", {\n      get: function get() {\n        return this._proxy;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(MockBase.prototype, \"name\", {\n      get: function get() {\n        return this._name;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(MockBase.prototype, \"callBase\", {\n      get: function get() {\n        return this._callBase;\n      },\n      set: function set(value) {\n        this._callBase = value;\n      },\n      enumerable: true,\n      configurable: true\n    });\n\n    MockBase.prototype.generateId = function () {\n      return \"Mock<\" + _.uniqueId() + \">\";\n    };\n\n    MockBase.prototype.getNameOf = function (instance) {\n      var result;\n\n      if (_.isFunction(instance)) {\n        result = Utils.functionName(instance);\n      } else if (_.isObject(instance)) {\n        var ctor = instance.constructor;\n        result = Utils.functionName(ctor);\n      }\n\n      if (result) result = result.trim();\n      return result;\n    };\n\n    MockBase.prototype.verifyAll = function () {\n      try {\n        this._interceptor.verify();\n      } catch (e) {\n        throw e;\n      }\n    };\n\n    MockBase.prototype.reset = function () {\n      this._interceptor.reset();\n    };\n\n    return MockBase;\n  }();\n\n  var InterceptionAction;\n\n  (function (InterceptionAction) {\n    InterceptionAction[InterceptionAction[\"Continue\"] = 0] = \"Continue\";\n    InterceptionAction[InterceptionAction[\"Stop\"] = 1] = \"Stop\";\n  })(InterceptionAction || (InterceptionAction = {}));\n\n  var InterceptorContext = function () {\n    function InterceptorContext(mock) {\n      this.mock = mock;\n      this._actualInvocations = [];\n      this._expectedCalls = [];\n    }\n\n    Object.defineProperty(InterceptorContext.prototype, \"behavior\", {\n      get: function get() {\n        return this.mock.behavior;\n      },\n      enumerable: true,\n      configurable: true\n    });\n\n    InterceptorContext.prototype.addInvocation = function (invocation) {\n      this._actualInvocations.push(invocation);\n    };\n\n    InterceptorContext.prototype.removeInvocation = function (invocation) {\n      _.remove(this._actualInvocations, function (x) {\n        return x === invocation;\n      });\n    };\n\n    InterceptorContext.prototype.actualInvocations = function () {\n      return this._actualInvocations;\n    };\n\n    InterceptorContext.prototype.clearInvocations = function () {\n      this._actualInvocations.splice(0, this._actualInvocations.length);\n    };\n\n    InterceptorContext.prototype.addExpectedCall = function (call) {\n      this._expectedCalls.push(call);\n    };\n\n    InterceptorContext.prototype.removeExpectedCall = function (call) {\n      _.filter(this._expectedCalls, function (x) {\n        return x.id !== call.id;\n      });\n    };\n\n    InterceptorContext.prototype.expectedCalls = function () {\n      return this._expectedCalls;\n    };\n\n    InterceptorContext.prototype.clearExpectedCalls = function () {\n      this._expectedCalls.splice(0, this._expectedCalls.length);\n    };\n\n    InterceptorContext.prototype.reset = function () {\n      this.clearInvocations();\n      this.clearExpectedCalls();\n    };\n\n    return InterceptorContext;\n  }();\n\n  var CurrentInterceptContext = function () {\n    function CurrentInterceptContext() {}\n\n    return CurrentInterceptContext;\n  }();\n\n  var AddActualInvocation = function () {\n    function AddActualInvocation() {}\n\n    AddActualInvocation.prototype.handleIntercept = function (invocation, ctx, localCtx) {\n      ctx.addInvocation(invocation);\n      return InterceptionAction.Continue;\n    };\n\n    return AddActualInvocation;\n  }();\n\n  var ExtractProxyCall = function () {\n    function ExtractProxyCall() {}\n\n    ExtractProxyCall.prototype.handleIntercept = function (invocation, ctx, localCtx) {\n      var expectedCalls = ctx.expectedCalls().slice();\n\n      var findCallPred = function findCallPred(c) {\n        return c.matches(invocation);\n      };\n\n      var matchingCalls = _.filter(expectedCalls, function (c) {\n        return findCallPred(c);\n      });\n\n      if (matchingCalls.length > 1) findCallPred = function findCallPred(c) {\n        return !c.isInvoked && c.matches(invocation);\n      };\n      localCtx.call = _.find(expectedCalls, function (c) {\n        return findCallPred(c);\n      });\n\n      if (localCtx.call != null) {\n        if (invocation.isAnUnknownDynamicCallAtExecution) {\n          invocation.callType = localCtx.call.setupCall.callType;\n          if (invocation.callType == CallType.FUNCTION) return InterceptionAction.Stop;\n        }\n\n        localCtx.call.evaluatedSuccessfully();\n      } else if (ctx.behavior == exports.MockBehavior.Strict) throw new MockException(MockExceptionReason.NoSetup, invocation, \"'\" + invocation + \"'\");\n\n      return InterceptionAction.Continue;\n    };\n\n    return ExtractProxyCall;\n  }();\n\n  var ExecuteCall = function () {\n    function ExecuteCall() {}\n\n    ExecuteCall.prototype.handleIntercept = function (invocation, ctx, localCtx) {\n      this._ctx = ctx;\n      var currentCall = localCtx.call;\n\n      if (currentCall != null) {\n        currentCall.execute(invocation);\n        return InterceptionAction.Stop;\n      }\n\n      return InterceptionAction.Continue;\n    };\n\n    return ExecuteCall;\n  }();\n\n  var InvokeBase = function () {\n    function InvokeBase() {}\n\n    InvokeBase.prototype.handleIntercept = function (invocation, ctx, localCtx) {\n      if (ctx.mock.callBase) {\n        invocation.invokeBase();\n        return InterceptionAction.Stop;\n      }\n\n      return InterceptionAction.Continue;\n    };\n\n    return InvokeBase;\n  }();\n\n  var HandleMockRecursion = function () {\n    function HandleMockRecursion() {}\n\n    HandleMockRecursion.prototype.handleIntercept = function (invocation, ctx, localCtx) {\n      return InterceptionAction.Continue;\n    };\n\n    return HandleMockRecursion;\n  }();\n\n  var InterceptorExecute = function () {\n    function InterceptorExecute(mock) {\n      this._interceptorContext = new InterceptorContext(mock);\n    }\n\n    Object.defineProperty(InterceptorExecute.prototype, \"interceptorContext\", {\n      get: function get() {\n        return this._interceptorContext;\n      },\n      enumerable: true,\n      configurable: true\n    });\n\n    InterceptorExecute.prototype.intercept = function (invocation) {\n      var _this = this;\n\n      var localCtx = new CurrentInterceptContext();\n      invocation.invocationType = InvocationType.EXECUTE;\n\n      _.some(this.interceptionStrategies(), function (strategy) {\n        if (InterceptionAction.Stop === strategy.handleIntercept(invocation, _this.interceptorContext, localCtx)) {\n          return true;\n        }\n      });\n    };\n\n    InterceptorExecute.prototype.removeInvocation = function (invocation) {\n      this._interceptorContext.removeInvocation(invocation);\n    };\n\n    InterceptorExecute.prototype.addExpectedCall = function (call) {\n      this._interceptorContext.addExpectedCall(call);\n    };\n\n    InterceptorExecute.prototype.verify = function () {\n      var expectedCalls = this._interceptorContext.expectedCalls();\n\n      var verifiableCalls = [];\n\n      if (this._interceptorContext.behavior == exports.MockBehavior.Strict) {\n        for (var _i = 0, expectedCalls_1 = expectedCalls; _i < expectedCalls_1.length; _i++) {\n          var call = expectedCalls_1[_i];\n          if (!call.isVerifiable) call.setVerifiable();\n          verifiableCalls.push(call);\n        }\n      } else {\n        verifiableCalls = _.filter(expectedCalls, function (c) {\n          return c.isVerifiable;\n        });\n      }\n\n      for (var _a = 0, verifiableCalls_1 = verifiableCalls; _a < verifiableCalls_1.length; _a++) {\n        var v = verifiableCalls_1[_a];\n        this.verifyCallCount(v, v.expectedCallCount);\n      }\n\n      var orderedCalls = _.filter(expectedCalls, function (c) {\n        return c.isInSequence;\n      });\n\n      this.verifyCallsOrder(orderedCalls);\n    };\n\n    InterceptorExecute.prototype.verifyCallCount = function (call, times) {\n      var expectedCalls = this._interceptorContext.expectedCalls();\n\n      var actualCalls = this._interceptorContext.actualInvocations();\n\n      var callCount = _.filter(actualCalls, function (c) {\n        return call.matches(c);\n      }).length;\n\n      if (!times.verify(callCount)) this.throwVerifyCallCountException(call.setupCall, times, expectedCalls, actualCalls);\n    };\n\n    InterceptorExecute.prototype.throwVerifyCallCountException = function (setupCall, times, expectedCalls, actualCalls) {\n      var failMsg = times.failMessage(setupCall);\n      var expectedCallsMsg = expectedCalls.reduce(function (a, x) {\n        return a + \" \" + x + \"\\n\";\n      }, \"\");\n      var actualCallsMsg = actualCalls.reduce(function (a, x) {\n        return a + \" \" + x + \"\\n\";\n      }, \"\");\n      var msg = failMsg + \"\\n Configured setups:\\n\" + expectedCallsMsg + \"\\n Performed invocations:\\n\" + actualCallsMsg;\n      var e = new MockException(MockExceptionReason.CallCountVerificationFailed, setupCall, msg);\n      throw e;\n    };\n\n    InterceptorExecute.prototype.verifyCallsOrder = function (expectedCalls) {\n      var actualCalls = this._interceptorContext.actualInvocations();\n\n      this.checkCallOrderExpectations(expectedCalls, actualCalls);\n    };\n\n    InterceptorExecute.prototype.checkCallOrderExpectations = function (expectedCalls, actualCalls) {\n      var checkOrder = function checkOrder(expectedCallCountList) {\n        var expectedCallCount = _.sum(expectedCallCountList);\n\n        var aci = 0;\n\n        for (var eci = 0; eci < expectedCallCountList.length; eci++) {\n          var expectedCall = expectedCalls[eci];\n          var expectedCallCount_1 = expectedCallCountList[eci];\n\n          for (var count = 1; count <= expectedCallCount_1; count++) {\n            var actualCall = actualCalls[aci++];\n            if (!expectedCall.matches(actualCall)) return false;\n          }\n        }\n\n        return aci === expectedCallCount;\n      };\n\n      var eureka = false;\n\n      var execute = function execute(acc, i) {\n        if (!eureka) {\n          if (i === expectedCalls.length) eureka = checkOrder(acc);else for (var j = expectedCalls[i].expectedCallCount.min; j <= expectedCalls[i].expectedCallCount.max; j++) {\n            acc[i] = j;\n            execute(acc, i + 1);\n          }\n        }\n      };\n\n      execute([], 0);\n      if (!eureka) this.throwVerifyCallOrderException();\n    };\n\n    InterceptorExecute.prototype.throwVerifyCallOrderException = function () {\n      var e = new MockException(MockExceptionReason.CallOrderVerificationFailed, null);\n      throw e;\n    };\n\n    InterceptorExecute.prototype.reset = function () {\n      this._interceptorContext.reset();\n    };\n\n    InterceptorExecute.prototype.interceptionStrategies = function () {\n      var strategies = [new AddActualInvocation(), new ExtractProxyCall(), new ExecuteCall(), new InvokeBase(), new HandleMockRecursion()];\n      return strategies;\n    };\n\n    return InterceptorExecute;\n  }();\n\n  var InterceptorSetup = function () {\n    function InterceptorSetup() {}\n\n    Object.defineProperty(InterceptorSetup.prototype, \"interceptedCall\", {\n      get: function get() {\n        return this._interceptedCall;\n      },\n      enumerable: true,\n      configurable: true\n    });\n\n    InterceptorSetup.prototype.intercept = function (invocation) {\n      invocation.invocationType = InvocationType.SETUP;\n      if (invocation.proxyType == ProxyType.DYNAMIC && invocation.callType == CallType.UNKNOWN) invocation.callType = CallType.PROPERTY;\n\n      if (this._interceptedCall) {\n        throw new MockException(MockExceptionReason.MoreThanOneSetup, invocation, \"'\" + invocation + \"'; setup should contain only one expression\");\n      }\n\n      this._interceptedCall = invocation;\n    };\n\n    InterceptorSetup.prototype.removeInvocation = function (invocation) {\n      if (this._interceptedCall && this._interceptedCall === invocation) this._interceptedCall = undefined;\n    };\n\n    return InterceptorSetup;\n  }();\n\n  var MethodCall = function () {\n    function MethodCall(mock, _setupExpression, interceptor, proxy) {\n      this.mock = mock;\n      this._setupExpression = _setupExpression;\n      this._callCount = 0;\n      this._id = this.generateId();\n\n      _setupExpression(proxy);\n\n      if (interceptor.interceptedCall) {\n        var ic = interceptor.interceptedCall;\n        var newArgs = this.transformToMatchers(ic.args);\n        Object.defineProperty(newArgs, \"callee\", {\n          configurable: true,\n          enumerable: true,\n          writable: false,\n          value: ic.args.callee\n        });\n        ic.args = newArgs;\n        this._setupCall = ic;\n      } else {\n        throw new MockException(MockExceptionReason.InvalidSetup, this._setupExpression, \"'\" + this._setupExpression + \"'\");\n      }\n    }\n\n    MethodCall.ofStaticMock = function (mock, setupExpression) {\n      var interceptor = new InterceptorSetup();\n      var proxy = ProxyFactory.createProxy(mock.target, interceptor);\n      var result = new MethodCall(mock, setupExpression, interceptor, proxy);\n      return result;\n    };\n\n    MethodCall.ofDynamicMock = function (mock, setupExpression) {\n      var interceptor = new InterceptorSetup();\n      var proxy = ProxyFactory.createProxyES6(mock.target, interceptor);\n      var result = new MethodCall(mock, setupExpression, interceptor, proxy);\n      return result;\n    };\n\n    MethodCall.prototype.generateId = function () {\n      return \"MethodCall<\" + _.uniqueId() + \">\";\n    };\n\n    MethodCall.prototype.transformToMatchers = function (args) {\n      var newArgs = [];\n\n      _.each(args, function (a) {\n        if (!_.isObject(a)) {\n          var newArg = new MatchValue(a);\n          newArgs.push(newArg);\n        } else {\n          if (Match.isMatcher(a)) {\n            newArgs.push(a);\n          } else {\n            var newArg = new MatchPred(function (x) {\n              return _.isEqual(x, a);\n            });\n            newArgs.push(newArg);\n          }\n        }\n      });\n\n      return newArgs;\n    };\n\n    Object.defineProperty(MethodCall.prototype, \"id\", {\n      get: function get() {\n        return this._id;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"setupExpression\", {\n      get: function get() {\n        return this._setupExpression;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"setupCall\", {\n      get: function get() {\n        return this._setupCall;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"isVerifiable\", {\n      get: function get() {\n        return this._isVerifiable;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"isInSequence\", {\n      get: function get() {\n        return this._expectedCallType === exports.ExpectedCallType.InSequence;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"expectedCallCount\", {\n      get: function get() {\n        return this._expectedCallCount;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"isInvoked\", {\n      get: function get() {\n        return this._isInvoked;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"callCount\", {\n      get: function get() {\n        return this._callCount;\n      },\n      enumerable: true,\n      configurable: true\n    });\n\n    MethodCall.prototype.setVerifiable = function (times, expectedCallType) {\n      if (times === void 0) {\n        times = Times.once();\n      }\n\n      if (expectedCallType === void 0) {\n        expectedCallType = exports.ExpectedCallType.InAnyOrder;\n      }\n\n      this._isVerifiable = true;\n      this._expectedCallCount = times;\n      this._expectedCallType = expectedCallType;\n    };\n\n    MethodCall.prototype.evaluatedSuccessfully = function () {\n      this._evaluatedSuccessfully = true;\n    };\n\n    MethodCall.prototype.matches = function (call) {\n      var match = false;\n\n      if (this._setupCall.property && call && call.property && this._setupCall.property.name === call.property.name) {\n        if (this._setupCall.args.length >= call.args.length) {\n          match = true;\n\n          if (!call.isAnUnknownDynamicCallAtExecution) {\n            _.each(this._setupCall.args, function (x, index) {\n              var setupArg = x;\n              var callArg = call.args[index];\n              if (match && !setupArg.___matches(callArg)) match = false;\n            });\n          }\n        }\n      }\n\n      return match;\n    };\n\n    MethodCall.prototype.execute = function (call) {\n      this._isInvoked = true;\n\n      if (this._setupCallback != null) {\n        this._setupCallback.apply(this, call.args);\n      }\n\n      if (this._thrownException != null) {\n        throw this._thrownException;\n      }\n\n      this._callCount++;\n    };\n\n    MethodCall.prototype.verifiable = function (times, expectedCallType) {\n      this.setVerifiable(times, expectedCallType);\n    };\n\n    MethodCall.prototype.toString = function () {\n      var res = \"\" + this.setupCall;\n      if (this.expectedCallCount) res = res + \", \" + this.expectedCallCount;\n      return res;\n    };\n\n    return MethodCall;\n  }();\n\n  var __extends$4 = undefined && undefined.__extends || function () {\n    var extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return function (d, b) {\n      extendStatics(d, b);\n\n      function __() {\n        this.constructor = d;\n      }\n\n      d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n  }();\n\n  var MethodCallReturn = function (_super) {\n    __extends$4(MethodCallReturn, _super);\n\n    function MethodCallReturn(mock, setupExpression, interceptor, proxy) {\n      var _this = _super.call(this, mock, setupExpression, interceptor, proxy) || this;\n\n      _this._overrideTarget = mock.canOverrideTarget;\n      return _this;\n    }\n\n    MethodCallReturn.ofStaticMock = function (mock, setupExpression) {\n      var interceptor = new InterceptorSetup();\n      var proxy = ProxyFactory.createProxy(mock.target, interceptor);\n      var result = new MethodCallReturn(mock, setupExpression, interceptor, proxy);\n      return result;\n    };\n\n    MethodCallReturn.ofDynamicMock = function (mock, setupExpression) {\n      var interceptor = new InterceptorSetup();\n      var proxy = ProxyFactory.createProxyES6(mock.target, interceptor);\n      var result = new MethodCallReturn(mock, setupExpression, interceptor, proxy);\n      return result;\n    };\n\n    MethodCallReturn.prototype.execute = function (call) {\n      _super.prototype.execute.call(this, call);\n\n      if (this._callBase) call.invokeBase();else if (this.hasReturnValue) {\n        call.returnValue = this._returnValueFunc.apply(this, call.args);\n        call.property.desc = {\n          value: this.setupCall.property.desc && this.setupCall.property.desc.value\n        };\n      }\n    };\n\n    MethodCallReturn.prototype.callback = function (action) {\n      this._setupCallback = action;\n      return this;\n    };\n\n    MethodCallReturn.prototype.throws = function (exception) {\n      this._thrownException = exception;\n      return this;\n    };\n\n    MethodCallReturn.prototype.returns = function (valueFunc) {\n      this._returnValueFunc = valueFunc;\n      this.hasReturnValue = true;\n\n      if (this._overrideTarget) {\n        var obj = this.mock.target;\n        var name_1 = this.setupCall.property.name;\n        var desc = this.setupCall.property.desc;\n\n        if (!desc && this.setupCall.proxyType == ProxyType.DYNAMIC) {\n          desc = {};\n          desc.configurable = true;\n          desc.enumerable = true;\n          if (this.setupCall.callType == CallType.FUNCTION) desc.value = this._returnValueFunc;else desc.get = this._returnValueFunc;\n          Object.defineProperty(obj, name_1, desc);\n        } else if (desc) {\n          desc.configurable = true;\n          desc.enumerable = true;\n          desc.value = this._returnValueFunc;\n          Object.defineProperty(obj, name_1, desc);\n        }\n      }\n\n      return this;\n    };\n\n    MethodCallReturn.prototype.callBase = function () {\n      this._callBase = true;\n      return this;\n    };\n\n    return MethodCallReturn;\n  }(MethodCall);\n\n  var __extends = undefined && undefined.__extends || function () {\n    var extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return function (d, b) {\n      extendStatics(d, b);\n\n      function __() {\n        this.constructor = d;\n      }\n\n      d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n  }();\n\n  var StaticMock = function (_super) {\n    __extends(StaticMock, _super);\n\n    function StaticMock(target, canOverrideTarget, behavior) {\n      var _this = _super.call(this, target, canOverrideTarget, behavior) || this;\n\n      _this._interceptor = new InterceptorExecute(_this);\n      _this._proxy = ProxyFactory.createProxy(target, _this._interceptor);\n      return _this;\n    }\n\n    StaticMock.ofInstance = function (targetInstance, behavior, shouldOverrideTarget) {\n      targetInstance = StaticMock.cloneDeep(targetInstance);\n      var mock = new StaticMock(targetInstance, shouldOverrideTarget, behavior);\n      return mock;\n    };\n\n    StaticMock.ofGlobalInstance = function (targetInstance, behavior) {\n      var mock = new StaticMock(targetInstance, false, behavior);\n      return mock;\n    };\n\n    StaticMock.ofType = function (targetConstructor, behavior, shouldOverrideTarget, targetConstructorArgs) {\n      var targetInstance = Utils.conthunktor(targetConstructor, targetConstructorArgs);\n      var mock = new StaticMock(targetInstance, shouldOverrideTarget, behavior);\n      return mock;\n    };\n\n    StaticMock.cloneDeep = function (target) {\n      var copy = target;\n\n      if (!_.isFunction(target)) {\n        var func = function func(x) {\n          var value;\n          if (ProxyES5.isProxy(x)) return x;\n        };\n\n        copy = _.cloneDeepWith(target, func);\n      }\n\n      return copy;\n    };\n\n    StaticMock.prototype.setup = function (expression) {\n      var call = MethodCallReturn.ofStaticMock(this, expression);\n\n      this._interceptor.addExpectedCall(call);\n\n      return call;\n    };\n\n    StaticMock.prototype.verify = function (expression, times) {\n      var call = MethodCall.ofStaticMock(this, expression);\n\n      this._interceptor.addExpectedCall(call);\n\n      try {\n        this._interceptor.verifyCallCount(call, times);\n      } catch (e) {\n        throw e;\n      }\n    };\n\n    return StaticMock;\n  }(MockBase);\n\n  var __extends$5 = undefined && undefined.__extends || function () {\n    var extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return function (d, b) {\n      extendStatics(d, b);\n\n      function __() {\n        this.constructor = d;\n      }\n\n      d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n  }();\n\n  var DynamicMock = function (_super) {\n    __extends$5(DynamicMock, _super);\n\n    function DynamicMock(target, name, canOverrideTarget, behavior) {\n      var _this = _super.call(this, target, canOverrideTarget, behavior) || this;\n\n      if (name) _this._name = name;\n      _this._interceptor = new InterceptorExecute(_this);\n      _this._proxy = ProxyFactory.createProxyES6(target, _this._interceptor);\n      return _this;\n    }\n\n    DynamicMock.ofType = function (name, behavior, shouldOverrideTarget) {\n      var mock = new DynamicMock(function () {}, name, shouldOverrideTarget, behavior);\n      return mock;\n    };\n\n    DynamicMock.prototype.setup = function (expression) {\n      var call = MethodCallReturn.ofDynamicMock(this, expression);\n\n      this._interceptor.addExpectedCall(call);\n\n      return call;\n    };\n\n    DynamicMock.prototype.verify = function (expression, times) {\n      var call = MethodCall.ofDynamicMock(this, expression);\n\n      this._interceptor.addExpectedCall(call);\n\n      try {\n        this._interceptor.verifyCallCount(call, times);\n      } catch (e) {\n        throw e;\n      }\n    };\n\n    return DynamicMock;\n  }(MockBase);\n\n  var MockApi = function () {\n    function MockApi() {}\n\n    MockApi.ofInstance = function (targetInstance, behavior, shouldOverrideTarget) {\n      if (behavior === void 0) {\n        behavior = exports.MockBehavior.Loose;\n      }\n\n      if (shouldOverrideTarget === void 0) {\n        shouldOverrideTarget = true;\n      }\n\n      var mock = StaticMock.ofInstance(targetInstance, behavior, shouldOverrideTarget);\n      return mock;\n    };\n\n    MockApi.ofType = function (targetConstructor, behavior, shouldOverrideTarget) {\n      if (behavior === void 0) {\n        behavior = exports.MockBehavior.Loose;\n      }\n\n      if (shouldOverrideTarget === void 0) {\n        shouldOverrideTarget = true;\n      }\n\n      var targetConstructorArgs = [];\n\n      for (var _i = 3; _i < arguments.length; _i++) {\n        targetConstructorArgs[_i - 3] = arguments[_i];\n      }\n\n      var mock;\n      if (targetConstructor) mock = MockApi.ofType2(targetConstructor, targetConstructorArgs, behavior, shouldOverrideTarget);else mock = DynamicMock.ofType(undefined, behavior, shouldOverrideTarget);\n      return mock;\n    };\n\n    MockApi.ofType2 = function (targetConstructor, targetConstructorArgs, behavior, shouldOverrideTarget) {\n      if (behavior === void 0) {\n        behavior = exports.MockBehavior.Loose;\n      }\n\n      if (shouldOverrideTarget === void 0) {\n        shouldOverrideTarget = true;\n      }\n\n      var mock = StaticMock.ofType(targetConstructor, behavior, shouldOverrideTarget, targetConstructorArgs);\n      return mock;\n    };\n\n    return MockApi;\n  }();\n\n  var It = function () {\n    function It() {}\n\n    It.isValue = function (x) {\n      var matcher = new MatchValue(x);\n      return matcher;\n    };\n\n    It.isObjectWith = function (x) {\n      var matcher = new MatchObjectWith(x);\n      return matcher;\n    };\n\n    It.isAnyObject = function (x) {\n      var matcher = new MatchAnyObject(x);\n      return matcher;\n    };\n\n    It.isAny = function () {\n      var matcher = new MatchAny();\n      return matcher;\n    };\n\n    It.isAnyString = function () {\n      var matcher = new MatchAnyString();\n      return matcher;\n    };\n\n    It.isAnyNumber = function () {\n      var matcher = new MatchAnyNumber();\n      return matcher;\n    };\n\n    It.is = function (predicate) {\n      var matcher = new MatchPred(predicate);\n      return matcher;\n    };\n\n    return It;\n  }();\n\n  var GlobalType;\n\n  (function (GlobalType) {\n    GlobalType[GlobalType[\"Class\"] = 0] = \"Class\";\n    GlobalType[GlobalType[\"Function\"] = 1] = \"Function\";\n    GlobalType[GlobalType[\"Value\"] = 2] = \"Value\";\n  })(GlobalType || (GlobalType = {}));\n\n  var GlobalMock = function () {\n    function GlobalMock(mock, _name, _type, container) {\n      this.mock = mock;\n      this._name = _name;\n      this._type = _type;\n      this.container = container;\n      if (!this._name) this._name = mock.name;\n    }\n\n    Object.defineProperty(GlobalMock.prototype, \"object\", {\n      get: function get() {\n        return this.mock.object;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(GlobalMock.prototype, \"target\", {\n      get: function get() {\n        return this.mock.target;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(GlobalMock.prototype, \"name\", {\n      get: function get() {\n        return this._name || this.mock.name;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(GlobalMock.prototype, \"behavior\", {\n      get: function get() {\n        return this.mock.behavior;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(GlobalMock.prototype, \"callBase\", {\n      get: function get() {\n        return this.mock.callBase;\n      },\n      set: function set(value) {\n        this.mock.callBase = value;\n      },\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(GlobalMock.prototype, \"type\", {\n      get: function get() {\n        return this._type;\n      },\n      enumerable: true,\n      configurable: true\n    });\n\n    GlobalMock.prototype.setup = function (expression) {\n      return this.mock.setup(expression);\n    };\n\n    GlobalMock.prototype.verify = function (expression, times) {\n      this.mock.verify(expression, times);\n    };\n\n    GlobalMock.prototype.verifyAll = function () {\n      this.mock.verifyAll();\n    };\n\n    GlobalMock.prototype.reset = function () {\n      this.mock.reset();\n    };\n\n    return GlobalMock;\n  }();\n\n  var GlobalMockApi = function () {\n    function GlobalMockApi() {}\n\n    GlobalMockApi.ofInstance = function (targetInstance, globalName, container, behavior) {\n      if (container === void 0) {\n        container = window;\n      }\n\n      if (behavior === void 0) {\n        behavior = exports.MockBehavior.Loose;\n      }\n\n      var mock = StaticMock.ofGlobalInstance(targetInstance, behavior);\n      var type = _.isFunction(targetInstance) ? GlobalType.Function : GlobalType.Value;\n      return new GlobalMock(mock, globalName, type, container);\n    };\n\n    GlobalMockApi.ofType = function (targetConstructor, container, behavior) {\n      if (container === void 0) {\n        container = window;\n      }\n\n      if (behavior === void 0) {\n        behavior = exports.MockBehavior.Loose;\n      }\n\n      var targetInstance = new targetConstructor();\n      var mock = StaticMock.ofInstance(targetInstance, behavior, false);\n      return new GlobalMock(mock, undefined, GlobalType.Class, container);\n    };\n\n    GlobalMockApi.ofType2 = function (globalName, container, behavior) {\n      if (container === void 0) {\n        container = window;\n      }\n\n      if (behavior === void 0) {\n        behavior = exports.MockBehavior.Loose;\n      }\n\n      var mock = DynamicMock.ofType(globalName, behavior, false);\n      return new GlobalMock(mock, undefined, GlobalType.Class, container);\n    };\n\n    return GlobalMockApi;\n  }();\n\n  var GlobalScope = function () {\n    function GlobalScope(_args) {\n      this._args = _args;\n    }\n\n    GlobalScope.prototype.with = function (action) {\n      var initial = {};\n\n      try {\n        _.each(this._args, function (a) {\n          var containerProps = PropertyRetriever.getOwnAndPrototypeEnumerablesAndNonenumerables(a.container);\n\n          var prop = _.find(containerProps, function (p) {\n            return p.name === a.name;\n          });\n\n          if (prop) {\n            initial[a.name] = prop.desc;\n            var desc = {};\n\n            switch (a.type) {\n              case GlobalType.Class:\n                desc.value = function () {\n                  return a.mock.object;\n                };\n\n                break;\n\n              case GlobalType.Function:\n                desc.value = a.mock.object;\n                break;\n\n              case GlobalType.Value:\n                desc.get = function () {\n                  return a.mock.object;\n                };\n\n                break;\n\n              default:\n                throw new MockException(MockExceptionReason.UnknownGlobalType, a, \"unknown global type: \" + a.type);\n            }\n\n            try {\n              Object.defineProperty(a.container, a.name, desc);\n            } catch (e) {\n              console.log(\"1: \" + e);\n            }\n          }\n        });\n\n        action.apply(this, this._args);\n      } catch (e) {\n        console.log(\"2: \" + e);\n      } finally {\n        _.each(this._args, function (a) {\n          var desc = initial[a.name];\n\n          if (desc) {\n            switch (a.type) {\n              case GlobalType.Class:\n                break;\n\n              case GlobalType.Function:\n                break;\n\n              case GlobalType.Value:\n                desc.configurable = true;\n                break;\n\n              default:\n            }\n\n            try {\n              Object.defineProperty(a.container, a.name, desc);\n            } catch (e) {\n              console.log(\"3: \" + e);\n            }\n          }\n        });\n      }\n    };\n\n    return GlobalScope;\n  }();\n\n  var GlobalScopeApi = function () {\n    function GlobalScopeApi() {}\n\n    GlobalScopeApi.using = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      var scope = new GlobalScope(args);\n      return scope;\n    };\n\n    return GlobalScopeApi;\n  }();\n\n  exports.Mock = MockApi;\n  exports.It = It;\n  exports.Times = Times;\n  exports.GlobalMock = GlobalMockApi;\n  exports.GlobalScope = GlobalScopeApi;\n  exports.MockException = MockException;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n}); //# sourceMappingURL=typemoq.js.map","map":{"version":3,"sources":["C:/Totvs/po-angular/node_modules/typemoq/dist/typemoq.js"],"names":["global","factory","exports","module","require","define","amd","TypeMoq","_","CircularJSON","MockBehavior","ExpectedCallType","__extends$1","undefined","__extends","extendStatics","Object","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","Exception","_super","name","message","_this","call","toString","errMsg","Error","__extends$2","MockExceptionReason","MockException","reason","ctx","Times","_condition","min","max","failMessage","_failMessage","template","i","c","_lastCallCount","verify","callCount","checkArg","n","target","InvalidArg","exactly","NO_MATCHING_CALLS_EXACTLY_N_TIMES","atLeast","NO_MATCHING_CALLS_AT_LEAST_N_TIMES","atMost","NO_MATCHING_CALLS_AT_MOST_N_TIMES","never","once","atLeastOnce","atMostOnce","res","PropertyRetriever","getOwnEnumerables","obj","_getPropertyNames","_enumerable","getOwnNonenumerables","_notEnumerable","getOwnEnumerablesAndNonenumerables","_enumerableAndNotEnumerable","getPrototypeEnumerables","getPrototypeNonenumerables","getPrototypeEnumerablesAndNonenumerables","getOwnAndPrototypeEnumerables","getOwnAndPrototypeNonenumerables","getOwnAndPrototypeEnumerablesAndNonenumerables","prop","propertyIsEnumerable","iterateSelfBool","iteratePrototypeBool","includePropCb","result","props","getOwnPropertyNames","_loop_1","duplicate","find","propDesc","getOwnPropertyDescriptor","push","desc","_i","props_1","length","getPrototypeOf","Consts","IMATCH_ID_VALUE","IMATCH_ID_NAME","IMATCH_MATCHES_NAME","IPROXY_ID_VALUE","IPROXY_ID_NAME","Match","isMatcher","x","isNil","isUndefined","Utils","functionName","fun","repr","substr","indexOf","objectName","argsName","args","argsArray","slice","sargs","map","replacer","key","value","isFunction","stringify","join","conthunktor","ctor","ret","bind","apply","concat","clone","source","sourceProps","sourceProps_1","defineProperty","MatchAnyObject","_ctor","___id","___matches","object","match","MatchAny","MatchAnyString","isString","MatchAnyNumber","isNumber","MatchPred","_pred","MatchValue","_value","cloneDeep","isEqual","valueName","MatchObjectWith","partial","pick","keys","CallType","ProxyType","__extends$3","InvocationType","BaseInvocation","proxyType","callType","invocationType","NONE","get","DYNAMIC","UNKNOWN","EXECUTE","enumerable","configurable","MethodInvocation","_that","_property","STATIC","FUNCTION","_args","callee","set","invokeBase","thatClone","returnValue","toFunc","property","ValueGetterInvocation","PROPERTY","writable","DynamicGetInvocation","ValueSetterInvocation","MethodGetterInvocation","_getter","MethodSetterInvocation","_setter","MethodInfo","func","objName","PropertyInfo","ProxyES5","interceptor","check","that","each","defineMethodProxy","defineValuePropertyProxy","defineGetSetPropertyProxy","of","funcName","methodProxyValue","isProxy","checkNotNullOrUndefined","ok","isObject","isPrimitiveObject","instance","isArray","isDate","isNull","propName","proxy","method","invocation","arguments","intercept","propValue","getProxy","setProxy","v","e","console","log","ProxyES6","handler","Proxy","Symbol","toStringTag","Function","InvalidDynamicProxyRuntime","ProxyES6Handler","_interceptor","thisArg","argArray","receiver","toPrimitive","invocation_1","removeInvocation","methodInvocation","Reflect","attributes","ProxyFactory","createProxy","createProxyES6","proxyHandler","MockBase","canOverrideTarget","behavior","Loose","_id","generateId","_name","getNameOf","_proxy","_callBase","uniqueId","trim","verifyAll","reset","InterceptionAction","InterceptorContext","mock","_actualInvocations","_expectedCalls","addInvocation","remove","actualInvocations","clearInvocations","splice","addExpectedCall","removeExpectedCall","filter","id","expectedCalls","clearExpectedCalls","CurrentInterceptContext","AddActualInvocation","handleIntercept","localCtx","Continue","ExtractProxyCall","findCallPred","matches","matchingCalls","isInvoked","isAnUnknownDynamicCallAtExecution","setupCall","Stop","evaluatedSuccessfully","Strict","NoSetup","ExecuteCall","_ctx","currentCall","execute","InvokeBase","callBase","HandleMockRecursion","InterceptorExecute","_interceptorContext","some","interceptionStrategies","strategy","interceptorContext","verifiableCalls","expectedCalls_1","isVerifiable","setVerifiable","_a","verifiableCalls_1","verifyCallCount","expectedCallCount","orderedCalls","isInSequence","verifyCallsOrder","times","actualCalls","throwVerifyCallCountException","failMsg","expectedCallsMsg","reduce","a","actualCallsMsg","msg","CallCountVerificationFailed","checkCallOrderExpectations","checkOrder","expectedCallCountList","sum","aci","eci","expectedCall","expectedCallCount_1","count","actualCall","eureka","acc","j","throwVerifyCallOrderException","CallOrderVerificationFailed","strategies","InterceptorSetup","_interceptedCall","SETUP","MoreThanOneSetup","MethodCall","_setupExpression","_callCount","interceptedCall","ic","newArgs","transformToMatchers","_setupCall","InvalidSetup","ofStaticMock","setupExpression","ofDynamicMock","newArg","_isVerifiable","_expectedCallType","InSequence","_expectedCallCount","_isInvoked","expectedCallType","InAnyOrder","_evaluatedSuccessfully","index","setupArg","callArg","_setupCallback","_thrownException","verifiable","__extends$4","MethodCallReturn","_overrideTarget","hasReturnValue","_returnValueFunc","callback","action","throws","exception","returns","valueFunc","name_1","StaticMock","ofInstance","targetInstance","shouldOverrideTarget","ofGlobalInstance","ofType","targetConstructor","targetConstructorArgs","copy","cloneDeepWith","setup","expression","__extends$5","DynamicMock","MockApi","ofType2","It","isValue","matcher","isObjectWith","isAnyObject","isAny","isAnyString","isAnyNumber","is","predicate","GlobalType","GlobalMock","_type","container","GlobalMockApi","globalName","window","type","Value","Class","GlobalScope","with","initial","containerProps","UnknownGlobalType","GlobalScopeApi","using","scope","Mock"],"mappings":"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","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('lodash'), require('circular-json')) :\n\ttypeof define === 'function' && define.amd ? define(['exports', 'lodash', 'circular-json'], factory) :\n\t(factory((global.TypeMoq = {}),global._,global.CircularJSON));\n}(this, (function (exports,_,CircularJSON) {\n\n(function (MockBehavior) {\n    MockBehavior[MockBehavior[\"Loose\"] = 0] = \"Loose\";\n    MockBehavior[MockBehavior[\"Strict\"] = 1] = \"Strict\";\n})(exports.MockBehavior || (exports.MockBehavior = {}));\n\n(function (ExpectedCallType) {\n    ExpectedCallType[ExpectedCallType[\"InAnyOrder\"] = 0] = \"InAnyOrder\";\n    ExpectedCallType[ExpectedCallType[\"InSequence\"] = 1] = \"InSequence\";\n})(exports.ExpectedCallType || (exports.ExpectedCallType = {}));\n\nvar __extends$1 = (undefined && undefined.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar Exception = (function (_super) {\n    __extends$1(Exception, _super);\n    function Exception(name, message) {\n        var _this = _super.call(this, message) || this;\n        _this.name = name;\n        Object.setPrototypeOf(_this, Exception.prototype);\n        return _this;\n    }\n    Exception.prototype.toString = function () {\n        var errMsg = this.message ? this.name + \" - \" + this.message : this.name;\n        return errMsg;\n    };\n    return Exception;\n}(Error));\n\nvar __extends$2 = (undefined && undefined.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar MockExceptionReason;\n(function (MockExceptionReason) {\n    MockExceptionReason[MockExceptionReason[\"NoSetup\"] = \"no setup expression found for\"] = \"NoSetup\";\n    MockExceptionReason[MockExceptionReason[\"MoreThanOneSetup\"] = \"more than one setup expression found for\"] = \"MoreThanOneSetup\";\n    MockExceptionReason[MockExceptionReason[\"InvalidArg\"] = \"invalid argument\"] = \"InvalidArg\";\n    MockExceptionReason[MockExceptionReason[\"InvalidSetup\"] = \"invalid setup expression\"] = \"InvalidSetup\";\n    MockExceptionReason[MockExceptionReason[\"InvalidMatcher\"] = \"invalid matching expression\"] = \"InvalidMatcher\";\n    MockExceptionReason[MockExceptionReason[\"UnknownGlobalType\"] = \"unknown global type\"] = \"UnknownGlobalType\";\n    MockExceptionReason[MockExceptionReason[\"CallCountVerificationFailed\"] = \"invocation count verification failed\"] = \"CallCountVerificationFailed\";\n    MockExceptionReason[MockExceptionReason[\"CallOrderVerificationFailed\"] = \"invocation order verification failed\"] = \"CallOrderVerificationFailed\";\n    MockExceptionReason[MockExceptionReason[\"InvalidDynamicProxyRuntime\"] = \"invalid dynamic proxy runtime\"] = \"InvalidDynamicProxyRuntime\";\n})(MockExceptionReason || (MockExceptionReason = {}));\nvar MockException = (function (_super) {\n    __extends$2(MockException, _super);\n    function MockException(reason, ctx, message) {\n        if (message === void 0) { message = undefined; }\n        var _this = _super.call(this, \"MockException\", message) || this;\n        _this.reason = reason;\n        _this.ctx = ctx;\n        _this.message = message;\n        Object.setPrototypeOf(_this, MockException.prototype);\n        return _this;\n    }\n    MockException.prototype.toString = function () {\n        var errMsg = this.name + \" - \" + this.reason;\n        if (this.message)\n            errMsg = errMsg + \" (\" + this.message + \")\";\n        return errMsg;\n    };\n    return MockException;\n}(Exception));\n\nvar Times = (function () {\n    function Times(_condition, min, max, failMessage) {\n        this._condition = _condition;\n        this.min = min;\n        this.max = max;\n        this._failMessage = _.template(failMessage);\n    }\n    Times.prototype.failMessage = function (call) {\n        return this._failMessage({ i: call, min: this.min, max: this.max, c: this._lastCallCount });\n    };\n    Times.prototype.verify = function (callCount) {\n        this._lastCallCount = callCount;\n        return this._condition(callCount);\n    };\n    Times.checkArg = function (n, target) {\n        if (n < 0)\n            throw new MockException(MockExceptionReason.InvalidArg, undefined, target + \" argument cannot be a negative number\");\n    };\n    Times.exactly = function (n) {\n        Times.checkArg(n, \"'Times.exactly'\");\n        return new Times(function (c) { return c === n; }, n, n, Times.NO_MATCHING_CALLS_EXACTLY_N_TIMES);\n    };\n    Times.atLeast = function (n) {\n        Times.checkArg(n, \"'Times.atLeast'\");\n        return new Times(function (c) { return c >= n; }, n, 255, Times.NO_MATCHING_CALLS_AT_LEAST_N_TIMES);\n    };\n    Times.atMost = function (n) {\n        Times.checkArg(n, \"'Times.atMost'\");\n        return new Times(function (c) { return c >= 0 && c <= n; }, 0, n, Times.NO_MATCHING_CALLS_AT_MOST_N_TIMES);\n    };\n    Times.never = function () {\n        return Times.exactly(0);\n    };\n    Times.once = function () {\n        return Times.exactly(1);\n    };\n    Times.atLeastOnce = function () {\n        return Times.atLeast(1);\n    };\n    Times.atMostOnce = function () {\n        return Times.atMost(1);\n    };\n    Times.prototype.toString = function () {\n        var res = \"\";\n        if (this.min === this.max) {\n            if (this.min === 0) {\n                res = \"never\";\n            }\n            else if (this.min === 1) {\n                res = \"once\";\n            }\n            else {\n                res = this.min + \" times\";\n            }\n        }\n        else {\n            if (this.min === 0 && this.max !== 255)\n                res = \"at most \" + this.max + \" times\";\n            else\n                res = \"at least \" + this.min + \" times\";\n        }\n        return res;\n    };\n    Times.NO_MATCHING_CALLS_EXACTLY_N_TIMES = \"expected invocation of <%= i %> exactly <%= min %> times, invoked <%= c %> times\";\n    Times.NO_MATCHING_CALLS_AT_LEAST_N_TIMES = \"expected invocation of <%= i %> at least <%= min %> times, invoked <%= c %> times\";\n    Times.NO_MATCHING_CALLS_AT_MOST_N_TIMES = \"expected invocation of <%= i %> at most <%= max %> times, invoked <%= c %> times\";\n    return Times;\n}());\n\nvar PropertyRetriever = (function () {\n    function PropertyRetriever() {\n    }\n    PropertyRetriever.getOwnEnumerables = function (obj) {\n        return this._getPropertyNames(obj, true, false, this._enumerable);\n    };\n    PropertyRetriever.getOwnNonenumerables = function (obj) {\n        return this._getPropertyNames(obj, true, false, this._notEnumerable);\n    };\n    PropertyRetriever.getOwnEnumerablesAndNonenumerables = function (obj) {\n        return this._getPropertyNames(obj, true, false, this._enumerableAndNotEnumerable);\n    };\n    PropertyRetriever.getPrototypeEnumerables = function (obj) {\n        return this._getPropertyNames(obj, false, true, this._enumerable);\n    };\n    PropertyRetriever.getPrototypeNonenumerables = function (obj) {\n        return this._getPropertyNames(obj, false, true, this._notEnumerable);\n    };\n    PropertyRetriever.getPrototypeEnumerablesAndNonenumerables = function (obj) {\n        return this._getPropertyNames(obj, false, true, this._enumerableAndNotEnumerable);\n    };\n    PropertyRetriever.getOwnAndPrototypeEnumerables = function (obj) {\n        return this._getPropertyNames(obj, true, true, this._enumerable);\n    };\n    PropertyRetriever.getOwnAndPrototypeNonenumerables = function (obj) {\n        return this._getPropertyNames(obj, true, true, this._notEnumerable);\n    };\n    PropertyRetriever.getOwnAndPrototypeEnumerablesAndNonenumerables = function (obj) {\n        return this._getPropertyNames(obj, true, true, this._enumerableAndNotEnumerable);\n    };\n    PropertyRetriever._enumerable = function (obj, prop) {\n        return obj.propertyIsEnumerable(prop);\n    };\n    PropertyRetriever._notEnumerable = function (obj, prop) {\n        return !obj.propertyIsEnumerable(prop);\n    };\n    PropertyRetriever._enumerableAndNotEnumerable = function (obj, prop) {\n        return true;\n    };\n    PropertyRetriever._getPropertyNames = function (obj, iterateSelfBool, iteratePrototypeBool, includePropCb) {\n        var result = [];\n        do {\n            if (iterateSelfBool) {\n                var props = Object.getOwnPropertyNames(obj);\n                var _loop_1 = function (prop) {\n                    var duplicate = _.find(result, function (p) { return p.name === prop; });\n                    if (!duplicate && includePropCb(obj, prop)) {\n                        var propDesc = Object.getOwnPropertyDescriptor(obj, prop);\n                        result.push({ name: prop, desc: propDesc });\n                    }\n                };\n                for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {\n                    var prop = props_1[_i];\n                    _loop_1(prop);\n                }\n                \n            }\n            if (!iteratePrototypeBool) {\n                break;\n            }\n            iterateSelfBool = true;\n        } while (obj = Object.getPrototypeOf(obj));\n        return result;\n    };\n    return PropertyRetriever;\n}());\n\nvar Consts = (function () {\n    function Consts() {\n    }\n    Consts.IMATCH_ID_VALUE = \"438A51D3-6864-49D7-A655-CA1153B86965\";\n    Consts.IMATCH_ID_NAME = \"___id\";\n    Consts.IMATCH_MATCHES_NAME = \"___matches\";\n    Consts.IPROXY_ID_VALUE = \"BCDF5CE5-F0DF-40B7-8BA0-69DF395033C8\";\n    Consts.IPROXY_ID_NAME = \"___id\";\n    return Consts;\n}());\n\nvar Match = (function () {\n    function Match() {\n    }\n    Match.isMatcher = function (x) {\n        return !_.isNil(x) &&\n            !_.isUndefined(x[Consts.IMATCH_MATCHES_NAME]) &&\n            !_.isUndefined(x[Consts.IMATCH_ID_NAME]) &&\n            x[Consts.IMATCH_ID_NAME] === Consts.IMATCH_ID_VALUE;\n    };\n    return Match;\n}());\n\nvar Utils = (function () {\n    function Utils() {\n    }\n    Utils.functionName = function (fun) {\n        var res;\n        if (fun.name) {\n            res = fun.name;\n        }\n        else {\n            var repr = fun.toString();\n            repr = repr.substr(\"function \".length);\n            res = repr.substr(0, repr.indexOf(\"(\"));\n        }\n        return res;\n    };\n    Utils.objectName = function (obj) {\n        var res = Utils.functionName(obj.constructor);\n        return res;\n    };\n    Utils.argsName = function (args) {\n        var argsArray = Array.prototype.slice.call(args);\n        var sargs = argsArray.map(function (x) {\n            var res = \"\";\n            if (Match.isMatcher(x)) {\n                res = x.toString();\n            }\n            else {\n                var replacer = function (key, value) {\n                    if (value === undefined)\n                        return \"undefined\";\n                    if (_.isFunction(value))\n                        return \"Function\";\n                    return value;\n                };\n                res = CircularJSON.stringify(x, replacer);\n            }\n            return res;\n        });\n        var res = _.join(sargs);\n        return res;\n    };\n    Utils.conthunktor = function (ctor, args) {\n        var ret = new (ctor.bind.apply(ctor, [void 0].concat(args)))();\n        return ret;\n    };\n    Utils.clone = function (target, source) {\n        var sourceProps = PropertyRetriever.getOwnAndPrototypeEnumerablesAndNonenumerables(source);\n        for (var _i = 0, sourceProps_1 = sourceProps; _i < sourceProps_1.length; _i++) {\n            var p = sourceProps_1[_i];\n            Object.defineProperty(target, p.name, p.desc);\n        }\n    };\n    return Utils;\n}());\n\nvar MatchAnyObject = (function () {\n    function MatchAnyObject(_ctor) {\n        this._ctor = _ctor;\n        this.___id = Consts.IMATCH_ID_VALUE;\n    }\n    MatchAnyObject.prototype.___matches = function (object) {\n        var match = false;\n        if (object && object.constructor.prototype == this._ctor.prototype)\n            match = true;\n        return match;\n    };\n    MatchAnyObject.prototype.toString = function () {\n        var res = \"It.isAnyObject(\" + Utils.functionName(this._ctor) + \")\";\n        return res;\n    };\n    return MatchAnyObject;\n}());\nvar MatchAny = (function () {\n    function MatchAny() {\n        this.___id = Consts.IMATCH_ID_VALUE;\n    }\n    MatchAny.prototype.___matches = function (object) {\n        var match = true;\n        return match;\n    };\n    MatchAny.prototype.toString = function () {\n        return \"It.isAny()\";\n    };\n    return MatchAny;\n}());\nvar MatchAnyString = (function () {\n    function MatchAnyString() {\n        this.___id = Consts.IMATCH_ID_VALUE;\n    }\n    MatchAnyString.prototype.___matches = function (object) {\n        var match = false;\n        if (_.isString(object))\n            match = true;\n        return match;\n    };\n    MatchAnyString.prototype.toString = function () {\n        return \"It.isAnyString()\";\n    };\n    return MatchAnyString;\n}());\nvar MatchAnyNumber = (function () {\n    function MatchAnyNumber() {\n        this.___id = Consts.IMATCH_ID_VALUE;\n    }\n    MatchAnyNumber.prototype.___matches = function (object) {\n        var match = false;\n        if (_.isNumber(object))\n            match = true;\n        return match;\n    };\n    MatchAnyNumber.prototype.toString = function () {\n        return \"It.isAnyNumber()\";\n    };\n    return MatchAnyNumber;\n}());\n\nvar MatchPred = (function () {\n    function MatchPred(_pred) {\n        this._pred = _pred;\n        this.___id = Consts.IMATCH_ID_VALUE;\n    }\n    MatchPred.prototype.___matches = function (object) {\n        var match = false;\n        if (object && this._pred(object))\n            match = true;\n        return match;\n    };\n    MatchPred.prototype.toString = function () {\n        var res = \"It.is(\" + this._pred + \")\";\n        return res;\n    };\n    return MatchPred;\n}());\n\nvar MatchValue = (function () {\n    function MatchValue(value) {\n        this.___id = Consts.IMATCH_ID_VALUE;\n        this._value = _.cloneDeep(value);\n    }\n    MatchValue.prototype.___matches = function (object) {\n        var match = false;\n        if (_.isEqual(this._value, object))\n            match = true;\n        return match;\n    };\n    MatchValue.prototype.toString = function () {\n        var valueName = Utils.argsName([this._value]);\n        var res = \"It.isValue(\" + valueName + \")\";\n        return res;\n    };\n    return MatchValue;\n}());\n\nvar MatchObjectWith = (function () {\n    function MatchObjectWith(value) {\n        this.___id = Consts.IMATCH_ID_VALUE;\n        this._value = _.cloneDeep(value);\n    }\n    MatchObjectWith.prototype.___matches = function (object) {\n        var match = false;\n        var partial = _.pick(object, _.keys(this._value));\n        if (_.isEqual(this._value, partial))\n            match = true;\n        return match;\n    };\n    MatchObjectWith.prototype.toString = function () {\n        var valueName = Utils.argsName([this._value]);\n        var res = \"It.isObjectWith(\" + valueName + \")\";\n        return res;\n    };\n    return MatchObjectWith;\n}());\n\nvar CallType;\n(function (CallType) {\n    CallType[CallType[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n    CallType[CallType[\"PROPERTY\"] = 1] = \"PROPERTY\";\n    CallType[CallType[\"FUNCTION\"] = 2] = \"FUNCTION\";\n})(CallType || (CallType = {}));\nvar ProxyType;\n(function (ProxyType) {\n    ProxyType[ProxyType[\"STATIC\"] = 0] = \"STATIC\";\n    ProxyType[ProxyType[\"DYNAMIC\"] = 1] = \"DYNAMIC\";\n})(ProxyType || (ProxyType = {}));\n\nvar __extends$3 = (undefined && undefined.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar InvocationType;\n(function (InvocationType) {\n    InvocationType[InvocationType[\"NONE\"] = 0] = \"NONE\";\n    InvocationType[InvocationType[\"SETUP\"] = 1] = \"SETUP\";\n    InvocationType[InvocationType[\"EXECUTE\"] = 2] = \"EXECUTE\";\n})(InvocationType || (InvocationType = {}));\nvar BaseInvocation = (function () {\n    function BaseInvocation(proxyType, callType) {\n        this.proxyType = proxyType;\n        this.callType = callType;\n        this.invocationType = InvocationType.NONE;\n    }\n    Object.defineProperty(BaseInvocation.prototype, \"isAnUnknownDynamicCallAtExecution\", {\n        get: function () {\n            return this.proxyType == ProxyType.DYNAMIC &&\n                this.callType == CallType.UNKNOWN &&\n                this.invocationType == InvocationType.EXECUTE;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    \n    return BaseInvocation;\n}());\nvar MethodInvocation = (function (_super) {\n    __extends$3(MethodInvocation, _super);\n    function MethodInvocation(_that, _property, args, proxyType, callType) {\n        if (proxyType === void 0) { proxyType = ProxyType.STATIC; }\n        if (callType === void 0) { callType = CallType.FUNCTION; }\n        var _this = _super.call(this, proxyType, callType) || this;\n        _this._that = _that;\n        _this._property = _property;\n        if (args) {\n            _this._args = _.cloneDeep(args);\n            _this._args.length = args.length;\n            _this._args.callee = args.callee;\n        }\n        return _this;\n    }\n    Object.defineProperty(MethodInvocation.prototype, \"args\", {\n        get: function () { return this._args || { length: 0, callee: null }; },\n        set: function (value) { this._args = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MethodInvocation.prototype, \"property\", {\n        get: function () { return this._property; },\n        enumerable: true,\n        configurable: true\n    });\n    MethodInvocation.prototype.invokeBase = function () {\n        var thatClone = {};\n        if (this._that)\n            Utils.clone(thatClone, this._that);\n        else\n            thatClone = this._property.obj;\n        this.returnValue = this._property.toFunc.apply(thatClone, this._args);\n    };\n    MethodInvocation.prototype.toString = function () {\n        var res = this.property + \"(\" + Utils.argsName(this.args) + \")\";\n        return res;\n    };\n    return MethodInvocation;\n}(BaseInvocation));\nvar ValueGetterInvocation = (function (_super) {\n    __extends$3(ValueGetterInvocation, _super);\n    function ValueGetterInvocation(_property, value, proxyType, callType) {\n        if (proxyType === void 0) { proxyType = ProxyType.STATIC; }\n        if (callType === void 0) { callType = CallType.PROPERTY; }\n        var _this = _super.call(this, proxyType, callType) || this;\n        _this._property = _property;\n        _this.value = value;\n        _this.returnValue = _.cloneDeep(value);\n        return _this;\n    }\n    Object.defineProperty(ValueGetterInvocation.prototype, \"args\", {\n        get: function () {\n            var args = [];\n            Object.defineProperty(args, \"callee\", { configurable: true, enumerable: true, writable: false, value: null });\n            return args;\n        },\n        set: function (value) { },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ValueGetterInvocation.prototype, \"property\", {\n        get: function () { return this._property; },\n        enumerable: true,\n        configurable: true\n    });\n    ValueGetterInvocation.prototype.invokeBase = function () {\n        this.returnValue = this._property.obj[this._property.name];\n    };\n    ValueGetterInvocation.prototype.toString = function () {\n        var res = \"\" + this.property;\n        return res;\n    };\n    return ValueGetterInvocation;\n}(BaseInvocation));\nvar DynamicGetInvocation = (function (_super) {\n    __extends$3(DynamicGetInvocation, _super);\n    function DynamicGetInvocation(property, value) {\n        var _this = _super.call(this, property, value, ProxyType.DYNAMIC, CallType.UNKNOWN) || this;\n        _this.returnValue = _.cloneDeep(value);\n        return _this;\n    }\n    return DynamicGetInvocation;\n}(ValueGetterInvocation));\nvar ValueSetterInvocation = (function (_super) {\n    __extends$3(ValueSetterInvocation, _super);\n    function ValueSetterInvocation(_property, args, proxyType, callType) {\n        if (proxyType === void 0) { proxyType = ProxyType.STATIC; }\n        if (callType === void 0) { callType = CallType.PROPERTY; }\n        var _this = _super.call(this, proxyType, callType) || this;\n        _this._property = _property;\n        _this._args = _.cloneDeep(args);\n        _this._args.length = args.length;\n        _this._args.callee = args.callee;\n        return _this;\n    }\n    Object.defineProperty(ValueSetterInvocation.prototype, \"args\", {\n        get: function () { return this._args; },\n        set: function (value) { this._args = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ValueSetterInvocation.prototype, \"property\", {\n        get: function () { return this._property; },\n        enumerable: true,\n        configurable: true\n    });\n    ValueSetterInvocation.prototype.invokeBase = function () {\n        this._property.obj[this._property.name] = this._args[0];\n        this.returnValue = this._property.obj[this._property.name];\n    };\n    ValueSetterInvocation.prototype.toString = function () {\n        var res = this.property + \" = \" + Utils.argsName(this.args[0]);\n        return res;\n    };\n    return ValueSetterInvocation;\n}(BaseInvocation));\nvar MethodGetterInvocation = (function (_super) {\n    __extends$3(MethodGetterInvocation, _super);\n    function MethodGetterInvocation(_property, _getter, proxyType, callType) {\n        if (proxyType === void 0) { proxyType = ProxyType.STATIC; }\n        if (callType === void 0) { callType = CallType.FUNCTION; }\n        var _this = _super.call(this, proxyType, callType) || this;\n        _this._property = _property;\n        _this._getter = _getter;\n        return _this;\n    }\n    Object.defineProperty(MethodGetterInvocation.prototype, \"args\", {\n        get: function () {\n            var args = [];\n            Object.defineProperty(args, \"callee\", { configurable: true, enumerable: true, writable: false, value: null });\n            return args;\n        },\n        set: function (value) { },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MethodGetterInvocation.prototype, \"property\", {\n        get: function () { return this._property; },\n        enumerable: true,\n        configurable: true\n    });\n    MethodGetterInvocation.prototype.invokeBase = function () {\n        this.returnValue = this._property.obj[this._property.name];\n    };\n    MethodGetterInvocation.prototype.toString = function () {\n        var res = \"\" + this.property;\n        return res;\n    };\n    return MethodGetterInvocation;\n}(BaseInvocation));\nvar MethodSetterInvocation = (function (_super) {\n    __extends$3(MethodSetterInvocation, _super);\n    function MethodSetterInvocation(_property, _setter, args, proxyType, callType) {\n        if (proxyType === void 0) { proxyType = ProxyType.STATIC; }\n        if (callType === void 0) { callType = CallType.FUNCTION; }\n        var _this = _super.call(this, proxyType, callType) || this;\n        _this._property = _property;\n        _this._setter = _setter;\n        _this._args = _.cloneDeep(args);\n        _this._args.length = args.length;\n        _this._args.callee = args.callee;\n        return _this;\n    }\n    Object.defineProperty(MethodSetterInvocation.prototype, \"args\", {\n        get: function () { return this._args; },\n        set: function (value) { this._args = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MethodSetterInvocation.prototype, \"property\", {\n        get: function () { return this._property; },\n        enumerable: true,\n        configurable: true\n    });\n    MethodSetterInvocation.prototype.invokeBase = function () {\n        this._property.obj[this._property.name] = this._args[0];\n        this.returnValue = this._property.obj[this._property.name];\n    };\n    MethodSetterInvocation.prototype.toString = function () {\n        var res = this.property + \"(\" + Utils.argsName(this.args[0]) + \")\";\n        return res;\n    };\n    return MethodSetterInvocation;\n}(BaseInvocation));\nvar MethodInfo = (function () {\n    function MethodInfo(obj, name, desc) {\n        this.obj = obj;\n        this.name = name;\n        if (desc)\n            this.desc = _.cloneDeep(desc);\n    }\n    Object.defineProperty(MethodInfo.prototype, \"toFunc\", {\n        get: function () {\n            var func = _.isFunction(this.obj) ? this.obj : this.obj[this.name];\n            return func;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    MethodInfo.prototype.toString = function () {\n        var objName = Utils.objectName(this.obj);\n        var res = _.isFunction(this.obj) ? \"\" + objName : objName + \".\" + this.name;\n        return res;\n    };\n    return MethodInfo;\n}());\nvar PropertyInfo = (function () {\n    function PropertyInfo(obj, name, desc) {\n        this.obj = obj;\n        this.name = name;\n        if (desc)\n            this.desc = _.cloneDeep(desc);\n    }\n    PropertyInfo.prototype.toString = function () {\n        var objName = Utils.objectName(this.obj);\n        var res = objName + \".\" + this.name;\n        return res;\n    };\n    return PropertyInfo;\n}());\n\nvar ProxyES5 = (function () {\n    function ProxyES5(target, interceptor) {\n        var _this = this;\n        this.___id = Consts.IPROXY_ID_VALUE;\n        this.check(target);\n        var that = this;\n        var props = PropertyRetriever.getOwnAndPrototypeEnumerablesAndNonenumerables(target);\n        _.each(props, function (prop) {\n            if (_.isFunction(prop.desc.value)) {\n                var propDesc = {\n                    configurable: prop.desc.configurable,\n                    enumerable: prop.desc.enumerable,\n                    writable: prop.desc.writable\n                };\n                _this.defineMethodProxy(that, interceptor, target, prop.name, propDesc);\n            }\n            else {\n                var propDesc = {\n                    configurable: prop.desc.configurable,\n                    enumerable: prop.desc.enumerable\n                };\n                if (prop.desc.value !== undefined)\n                    _this.defineValuePropertyProxy(that, interceptor, target, prop.name, prop.desc.value, propDesc);\n                else\n                    _this.defineGetSetPropertyProxy(that, interceptor, target, prop.name, prop.desc.get, prop.desc.set, propDesc);\n            }\n        });\n    }\n    ProxyES5.of = function (target, interceptor) {\n        ProxyES5.check(target);\n        var result;\n        if (_.isFunction(target)) {\n            var funcName = Utils.functionName(target);\n            result = ProxyES5.methodProxyValue(undefined, interceptor, target, funcName, null);\n        }\n        else {\n            result = new ProxyES5(target, interceptor);\n        }\n        return result;\n    };\n    ProxyES5.isProxy = function (obj) {\n        if (!_.isNil(obj) &&\n            !_.isUndefined(obj[Consts.IPROXY_ID_NAME]) && obj[Consts.IPROXY_ID_NAME] === Consts.IPROXY_ID_VALUE)\n            return true;\n        else\n            return false;\n    };\n    ProxyES5.check = function (target) {\n        ProxyES5.checkNotNullOrUndefined(target);\n        var ok = false;\n        if (_.isFunction(target) ||\n            (_.isObject(target) && !ProxyES5.isPrimitiveObject(target)))\n            ok = true;\n        if (!ok)\n            throw new MockException(MockExceptionReason.InvalidArg, target, \"'\" + target + \"'; proxy argument should be a function or a non primitive object\");\n    };\n    ProxyES5.prototype.check = function (target) {\n        ProxyES5.checkNotNullOrUndefined(target);\n        var ok = false;\n        if (!_.isFunction(target) &&\n            (_.isObject(target) && !ProxyES5.isPrimitiveObject(target)))\n            ok = true;\n        if (!ok)\n            throw new MockException(MockExceptionReason.InvalidArg, target, \"'\" + target + \"'; proxy argument should be a non primitive object\");\n    };\n    ProxyES5.checkNotNullOrUndefined = function (instance) {\n        if (_.isNil(instance))\n            throw new MockException(MockExceptionReason.InvalidArg, instance, \"'\" + instance + \"'; proxy argument is required\");\n    };\n    ProxyES5.isPrimitiveObject = function (obj) {\n        var result = false;\n        if (_.isFunction(obj) ||\n            _.isArray(obj) ||\n            _.isDate(obj) ||\n            _.isNull(obj))\n            result = true;\n        return result;\n    };\n    ProxyES5.prototype.defineMethodProxy = function (that, interceptor, target, propName, propDesc) {\n        if (propDesc === void 0) { propDesc = { configurable: true, enumerable: true, writable: false }; }\n        propDesc.value = ProxyES5.methodProxyValue(that, interceptor, target, propName, propDesc);\n        this.defineProperty(that, propName, propDesc);\n    };\n    ProxyES5.methodProxyValue = function (that, interceptor, target, propName, propDesc) {\n        function proxy() {\n            var method = new MethodInfo(target, propName, propDesc);\n            var invocation = new MethodInvocation(that, method, arguments);\n            interceptor.intercept(invocation);\n            return invocation.returnValue;\n        }\n        return proxy;\n    };\n    ProxyES5.prototype.defineValuePropertyProxy = function (that, interceptor, target, propName, propValue, propDesc) {\n        if (propDesc === void 0) { propDesc = { configurable: true, enumerable: true }; }\n        function getProxy() {\n            var method = new PropertyInfo(target, propName);\n            var invocation = new ValueGetterInvocation(method, propValue);\n            interceptor.intercept(invocation);\n            return invocation.returnValue;\n        }\n        propDesc.get = getProxy;\n        function setProxy(v) {\n            var method = new PropertyInfo(target, propName);\n            var invocation = new ValueSetterInvocation(method, arguments);\n            interceptor.intercept(invocation);\n        }\n        propDesc.set = setProxy;\n        this.defineProperty(that, propName, propDesc);\n    };\n    ProxyES5.prototype.defineGetSetPropertyProxy = function (that, interceptor, target, propName, get, set, propDesc) {\n        if (propDesc === void 0) { propDesc = { configurable: true, enumerable: true }; }\n        function getProxy() {\n            var method = new PropertyInfo(target, propName);\n            var invocation = new MethodGetterInvocation(method, get);\n            interceptor.intercept(invocation);\n            return invocation.returnValue;\n        }\n        propDesc.get = getProxy;\n        function setProxy(v) {\n            var method = new PropertyInfo(target, propName);\n            var invocation = new MethodSetterInvocation(method, set, arguments);\n            interceptor.intercept(invocation);\n        }\n        propDesc.set = setProxy;\n        this.defineProperty(that, propName, propDesc);\n    };\n    ProxyES5.prototype.defineProperty = function (obj, name, desc) {\n        try {\n            Object.defineProperty(obj, name, desc);\n        }\n        catch (e) {\n            console.log(e.message);\n        }\n    };\n    return ProxyES5;\n}());\n\nvar ProxyES6 = (function () {\n    function ProxyES6(target, handler) {\n        this.___id = Consts.IPROXY_ID_VALUE;\n        var p = new Proxy(target, handler);\n        p[Symbol.toStringTag] = Function.prototype.toString.bind(target);\n        return p;\n    }\n    ProxyES6.of = function (target, handler) {\n        ProxyES6.check();\n        var result = new ProxyES6(target, handler);\n        return result;\n    };\n    ProxyES6.check = function () {\n        if (typeof Proxy === \"undefined\")\n            throw new MockException(MockExceptionReason.InvalidDynamicProxyRuntime, null, \"ES6 Proxy object not detected; the dynamic mocking feature requires ES6 Proxy object support\");\n    };\n    return ProxyES6;\n}());\n\nvar ProxyES6Handler = (function () {\n    function ProxyES6Handler(_interceptor) {\n        this._interceptor = _interceptor;\n    }\n    ProxyES6Handler.prototype.apply = function (target, thisArg, argArray) {\n        var funcName = Utils.functionName(target);\n        var method = new MethodInfo(target, funcName);\n        var invocation = new MethodInvocation(target, method, argArray, ProxyType.DYNAMIC);\n        this._interceptor.intercept(invocation);\n        return invocation.returnValue;\n    };\n    ProxyES6Handler.prototype.get = function (target, p, receiver) {\n        var _this = this;\n        if (p !== Symbol.toStringTag &&\n            p !== Symbol.toPrimitive &&\n            p !== \"toJSON\") {\n            var propValue = target[p];\n            var method = new PropertyInfo(target, p);\n            var invocation_1 = new DynamicGetInvocation(method, propValue);\n            this._interceptor.intercept(invocation_1);\n            if (invocation_1.callType == CallType.PROPERTY &&\n                invocation_1.property.desc)\n                return invocation_1.returnValue;\n            else\n                return function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    _this._interceptor.removeInvocation(invocation_1);\n                    var method = new MethodInfo(target, p);\n                    var methodInvocation = new MethodInvocation(target, method, args, ProxyType.DYNAMIC);\n                    _this._interceptor.intercept(methodInvocation);\n                    return methodInvocation.returnValue;\n                };\n        }\n        else\n            return Reflect.get(target, p, receiver);\n    };\n    ProxyES6Handler.prototype.set = function (target, p, value, receiver) {\n        if (p !== Symbol.toStringTag) {\n            var method = new PropertyInfo(target, p);\n            var invocation = new ValueSetterInvocation(method, [value], ProxyType.DYNAMIC);\n            this._interceptor.intercept(invocation);\n        }\n        return Reflect.set(target, p, value, receiver);\n    };\n    ProxyES6Handler.prototype.defineProperty = function (target, p, attributes) {\n        attributes.configurable = true;\n        return Reflect.defineProperty(target, p, attributes);\n    };\n    return ProxyES6Handler;\n}());\n\nvar ProxyFactory = (function () {\n    function ProxyFactory() {\n    }\n    ProxyFactory.createProxy = function (target, interceptor) {\n        var proxy = ProxyES5.of(target, interceptor);\n        return proxy;\n    };\n    ProxyFactory.createProxyES6 = function (target, interceptor) {\n        var proxyHandler = new ProxyES6Handler(interceptor);\n        var proxy = ProxyES6.of(target, proxyHandler);\n        return proxy;\n    };\n    return ProxyFactory;\n}());\n\nvar MockBase = (function () {\n    function MockBase(target, canOverrideTarget, behavior) {\n        if (behavior === void 0) { behavior = exports.MockBehavior.Loose; }\n        this.target = target;\n        this.canOverrideTarget = canOverrideTarget;\n        this.behavior = behavior;\n        this._id = this.generateId();\n        this._name = this.getNameOf(this.target);\n    }\n    Object.defineProperty(MockBase.prototype, \"object\", {\n        get: function () { return this._proxy; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MockBase.prototype, \"name\", {\n        get: function () { return this._name; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MockBase.prototype, \"callBase\", {\n        get: function () { return this._callBase; },\n        set: function (value) { this._callBase = value; },\n        enumerable: true,\n        configurable: true\n    });\n    MockBase.prototype.generateId = function () {\n        return \"Mock<\" + _.uniqueId() + \">\";\n    };\n    MockBase.prototype.getNameOf = function (instance) {\n        var result;\n        if (_.isFunction(instance)) {\n            result = Utils.functionName(instance);\n        }\n        else if (_.isObject(instance)) {\n            var ctor = instance.constructor;\n            result = Utils.functionName(ctor);\n        }\n        if (result)\n            result = result.trim();\n        return result;\n    };\n    MockBase.prototype.verifyAll = function () {\n        try {\n            this._interceptor.verify();\n        }\n        catch (e) {\n            throw e;\n        }\n    };\n    MockBase.prototype.reset = function () {\n        this._interceptor.reset();\n    };\n    return MockBase;\n}());\n\nvar InterceptionAction;\n(function (InterceptionAction) {\n    InterceptionAction[InterceptionAction[\"Continue\"] = 0] = \"Continue\";\n    InterceptionAction[InterceptionAction[\"Stop\"] = 1] = \"Stop\";\n})(InterceptionAction || (InterceptionAction = {}));\nvar InterceptorContext = (function () {\n    function InterceptorContext(mock) {\n        this.mock = mock;\n        this._actualInvocations = [];\n        this._expectedCalls = [];\n    }\n    Object.defineProperty(InterceptorContext.prototype, \"behavior\", {\n        get: function () { return this.mock.behavior; },\n        enumerable: true,\n        configurable: true\n    });\n    InterceptorContext.prototype.addInvocation = function (invocation) { this._actualInvocations.push(invocation); };\n    InterceptorContext.prototype.removeInvocation = function (invocation) {\n        _.remove(this._actualInvocations, function (x) {\n            return x === invocation;\n        });\n    };\n    InterceptorContext.prototype.actualInvocations = function () { return this._actualInvocations; };\n    InterceptorContext.prototype.clearInvocations = function () { this._actualInvocations.splice(0, this._actualInvocations.length); };\n    InterceptorContext.prototype.addExpectedCall = function (call) { this._expectedCalls.push(call); };\n    InterceptorContext.prototype.removeExpectedCall = function (call) {\n        _.filter(this._expectedCalls, function (x) {\n            return x.id !== call.id;\n        });\n    };\n    InterceptorContext.prototype.expectedCalls = function () { return this._expectedCalls; };\n    InterceptorContext.prototype.clearExpectedCalls = function () { this._expectedCalls.splice(0, this._expectedCalls.length); };\n    InterceptorContext.prototype.reset = function () {\n        this.clearInvocations();\n        this.clearExpectedCalls();\n    };\n    return InterceptorContext;\n}());\n\nvar CurrentInterceptContext = (function () {\n    function CurrentInterceptContext() {\n    }\n    return CurrentInterceptContext;\n}());\n\nvar AddActualInvocation = (function () {\n    function AddActualInvocation() {\n    }\n    AddActualInvocation.prototype.handleIntercept = function (invocation, ctx, localCtx) {\n        ctx.addInvocation(invocation);\n        return InterceptionAction.Continue;\n    };\n    return AddActualInvocation;\n}());\nvar ExtractProxyCall = (function () {\n    function ExtractProxyCall() {\n    }\n    ExtractProxyCall.prototype.handleIntercept = function (invocation, ctx, localCtx) {\n        var expectedCalls = ctx.expectedCalls().slice();\n        var findCallPred = function (c) { return c.matches(invocation); };\n        var matchingCalls = _.filter(expectedCalls, function (c) {\n            return findCallPred(c);\n        });\n        if (matchingCalls.length > 1)\n            findCallPred = function (c) { return !c.isInvoked &&\n                c.matches(invocation); };\n        localCtx.call = _.find(expectedCalls, function (c) {\n            return findCallPred(c);\n        });\n        if (localCtx.call != null) {\n            if (invocation.isAnUnknownDynamicCallAtExecution) {\n                invocation.callType = localCtx.call.setupCall.callType;\n                if (invocation.callType == CallType.FUNCTION)\n                    return InterceptionAction.Stop;\n            }\n            localCtx.call.evaluatedSuccessfully();\n        }\n        else if (ctx.behavior == exports.MockBehavior.Strict)\n            throw new MockException(MockExceptionReason.NoSetup, invocation, \"'\" + invocation + \"'\");\n        return InterceptionAction.Continue;\n    };\n    return ExtractProxyCall;\n}());\nvar ExecuteCall = (function () {\n    function ExecuteCall() {\n    }\n    ExecuteCall.prototype.handleIntercept = function (invocation, ctx, localCtx) {\n        this._ctx = ctx;\n        var currentCall = localCtx.call;\n        if (currentCall != null) {\n            currentCall.execute(invocation);\n            return InterceptionAction.Stop;\n        }\n        return InterceptionAction.Continue;\n    };\n    return ExecuteCall;\n}());\nvar InvokeBase = (function () {\n    function InvokeBase() {\n    }\n    InvokeBase.prototype.handleIntercept = function (invocation, ctx, localCtx) {\n        if (ctx.mock.callBase) {\n            invocation.invokeBase();\n            return InterceptionAction.Stop;\n        }\n        return InterceptionAction.Continue;\n    };\n    return InvokeBase;\n}());\nvar HandleMockRecursion = (function () {\n    function HandleMockRecursion() {\n    }\n    HandleMockRecursion.prototype.handleIntercept = function (invocation, ctx, localCtx) {\n        return InterceptionAction.Continue;\n    };\n    return HandleMockRecursion;\n}());\n\nvar InterceptorExecute = (function () {\n    function InterceptorExecute(mock) {\n        this._interceptorContext = new InterceptorContext(mock);\n    }\n    Object.defineProperty(InterceptorExecute.prototype, \"interceptorContext\", {\n        get: function () { return this._interceptorContext; },\n        enumerable: true,\n        configurable: true\n    });\n    InterceptorExecute.prototype.intercept = function (invocation) {\n        var _this = this;\n        var localCtx = new CurrentInterceptContext();\n        invocation.invocationType = InvocationType.EXECUTE;\n        _.some(this.interceptionStrategies(), function (strategy) {\n            if (InterceptionAction.Stop === strategy.handleIntercept(invocation, _this.interceptorContext, localCtx)) {\n                return true;\n            }\n        });\n    };\n    InterceptorExecute.prototype.removeInvocation = function (invocation) {\n        this._interceptorContext.removeInvocation(invocation);\n    };\n    InterceptorExecute.prototype.addExpectedCall = function (call) {\n        this._interceptorContext.addExpectedCall(call);\n    };\n    InterceptorExecute.prototype.verify = function () {\n        var expectedCalls = this._interceptorContext.expectedCalls();\n        var verifiableCalls = [];\n        if (this._interceptorContext.behavior == exports.MockBehavior.Strict) {\n            for (var _i = 0, expectedCalls_1 = expectedCalls; _i < expectedCalls_1.length; _i++) {\n                var call = expectedCalls_1[_i];\n                if (!call.isVerifiable)\n                    call.setVerifiable();\n                verifiableCalls.push(call);\n            }\n        }\n        else {\n            verifiableCalls = _.filter(expectedCalls, function (c) { return c.isVerifiable; });\n        }\n        for (var _a = 0, verifiableCalls_1 = verifiableCalls; _a < verifiableCalls_1.length; _a++) {\n            var v = verifiableCalls_1[_a];\n            this.verifyCallCount(v, v.expectedCallCount);\n        }\n        var orderedCalls = _.filter(expectedCalls, function (c) { return c.isInSequence; });\n        this.verifyCallsOrder(orderedCalls);\n    };\n    InterceptorExecute.prototype.verifyCallCount = function (call, times) {\n        var expectedCalls = this._interceptorContext.expectedCalls();\n        var actualCalls = this._interceptorContext.actualInvocations();\n        var callCount = _.filter(actualCalls, function (c) { return call.matches(c); }).length;\n        if (!times.verify(callCount))\n            this.throwVerifyCallCountException(call.setupCall, times, expectedCalls, actualCalls);\n    };\n    InterceptorExecute.prototype.throwVerifyCallCountException = function (setupCall, times, expectedCalls, actualCalls) {\n        var failMsg = times.failMessage(setupCall);\n        var expectedCallsMsg = expectedCalls.reduce(function (a, x) { return a + \" \" + x + \"\\n\"; }, \"\");\n        var actualCallsMsg = actualCalls.reduce(function (a, x) { return a + \" \" + x + \"\\n\"; }, \"\");\n        var msg = failMsg + \"\\n Configured setups:\\n\" + expectedCallsMsg + \"\\n Performed invocations:\\n\" + actualCallsMsg;\n        var e = new MockException(MockExceptionReason.CallCountVerificationFailed, setupCall, msg);\n        throw e;\n    };\n    InterceptorExecute.prototype.verifyCallsOrder = function (expectedCalls) {\n        var actualCalls = this._interceptorContext.actualInvocations();\n        this.checkCallOrderExpectations(expectedCalls, actualCalls);\n    };\n    InterceptorExecute.prototype.checkCallOrderExpectations = function (expectedCalls, actualCalls) {\n        var checkOrder = function (expectedCallCountList) {\n            var expectedCallCount = _.sum(expectedCallCountList);\n            var aci = 0;\n            for (var eci = 0; eci < expectedCallCountList.length; eci++) {\n                var expectedCall = expectedCalls[eci];\n                var expectedCallCount_1 = expectedCallCountList[eci];\n                for (var count = 1; count <= expectedCallCount_1; count++) {\n                    var actualCall = actualCalls[aci++];\n                    if (!expectedCall.matches(actualCall))\n                        return false;\n                }\n            }\n            return aci === expectedCallCount;\n        };\n        var eureka = false;\n        var execute = function (acc, i) {\n            if (!eureka) {\n                if (i === expectedCalls.length)\n                    eureka = checkOrder(acc);\n                else\n                    for (var j = expectedCalls[i].expectedCallCount.min; j <= expectedCalls[i].expectedCallCount.max; j++) {\n                        acc[i] = j;\n                        execute(acc, i + 1);\n                    }\n            }\n        };\n        execute([], 0);\n        if (!eureka)\n            this.throwVerifyCallOrderException();\n    };\n    InterceptorExecute.prototype.throwVerifyCallOrderException = function () {\n        var e = new MockException(MockExceptionReason.CallOrderVerificationFailed, null);\n        throw e;\n    };\n    InterceptorExecute.prototype.reset = function () {\n        this._interceptorContext.reset();\n    };\n    InterceptorExecute.prototype.interceptionStrategies = function () {\n        var strategies = [\n            new AddActualInvocation(),\n            new ExtractProxyCall(),\n            new ExecuteCall(),\n            new InvokeBase(),\n            new HandleMockRecursion()\n        ];\n        return strategies;\n    };\n    return InterceptorExecute;\n}());\n\nvar InterceptorSetup = (function () {\n    function InterceptorSetup() {\n    }\n    Object.defineProperty(InterceptorSetup.prototype, \"interceptedCall\", {\n        get: function () { return this._interceptedCall; },\n        enumerable: true,\n        configurable: true\n    });\n    InterceptorSetup.prototype.intercept = function (invocation) {\n        invocation.invocationType = InvocationType.SETUP;\n        if (invocation.proxyType == ProxyType.DYNAMIC &&\n            invocation.callType == CallType.UNKNOWN)\n            invocation.callType = CallType.PROPERTY;\n        if (this._interceptedCall) {\n            throw new MockException(MockExceptionReason.MoreThanOneSetup, invocation, \"'\" + invocation + \"'; setup should contain only one expression\");\n        }\n        this._interceptedCall = invocation;\n    };\n    InterceptorSetup.prototype.removeInvocation = function (invocation) {\n        if (this._interceptedCall &&\n            this._interceptedCall === invocation)\n            this._interceptedCall = undefined;\n    };\n    return InterceptorSetup;\n}());\n\nvar MethodCall = (function () {\n    function MethodCall(mock, _setupExpression, interceptor, proxy) {\n        this.mock = mock;\n        this._setupExpression = _setupExpression;\n        this._callCount = 0;\n        this._id = this.generateId();\n        _setupExpression(proxy);\n        if (interceptor.interceptedCall) {\n            var ic = interceptor.interceptedCall;\n            var newArgs = this.transformToMatchers(ic.args);\n            Object.defineProperty(newArgs, \"callee\", { configurable: true, enumerable: true, writable: false, value: ic.args.callee });\n            ic.args = newArgs;\n            this._setupCall = ic;\n        }\n        else {\n            throw new MockException(MockExceptionReason.InvalidSetup, this._setupExpression, \"'\" + this._setupExpression + \"'\");\n        }\n    }\n    MethodCall.ofStaticMock = function (mock, setupExpression) {\n        var interceptor = new InterceptorSetup();\n        var proxy = ProxyFactory.createProxy(mock.target, interceptor);\n        var result = new MethodCall(mock, setupExpression, interceptor, proxy);\n        return result;\n    };\n    MethodCall.ofDynamicMock = function (mock, setupExpression) {\n        var interceptor = new InterceptorSetup();\n        var proxy = ProxyFactory.createProxyES6(mock.target, interceptor);\n        var result = new MethodCall(mock, setupExpression, interceptor, proxy);\n        return result;\n    };\n    MethodCall.prototype.generateId = function () {\n        return \"MethodCall<\" + _.uniqueId() + \">\";\n    };\n    MethodCall.prototype.transformToMatchers = function (args) {\n        var newArgs = [];\n        _.each(args, function (a) {\n            if (!_.isObject(a)) {\n                var newArg = new MatchValue(a);\n                newArgs.push(newArg);\n            }\n            else {\n                if (Match.isMatcher(a)) {\n                    newArgs.push(a);\n                }\n                else {\n                    var newArg = new MatchPred(function (x) { return _.isEqual(x, a); });\n                    newArgs.push(newArg);\n                }\n            }\n        });\n        return newArgs;\n    };\n    Object.defineProperty(MethodCall.prototype, \"id\", {\n        get: function () { return this._id; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"setupExpression\", {\n        get: function () { return this._setupExpression; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"setupCall\", {\n        get: function () { return this._setupCall; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"isVerifiable\", {\n        get: function () { return this._isVerifiable; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"isInSequence\", {\n        get: function () { return this._expectedCallType === exports.ExpectedCallType.InSequence; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"expectedCallCount\", {\n        get: function () { return this._expectedCallCount; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"isInvoked\", {\n        get: function () { return this._isInvoked; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MethodCall.prototype, \"callCount\", {\n        get: function () { return this._callCount; },\n        enumerable: true,\n        configurable: true\n    });\n    MethodCall.prototype.setVerifiable = function (times, expectedCallType) {\n        if (times === void 0) { times = Times.once(); }\n        if (expectedCallType === void 0) { expectedCallType = exports.ExpectedCallType.InAnyOrder; }\n        this._isVerifiable = true;\n        this._expectedCallCount = times;\n        this._expectedCallType = expectedCallType;\n    };\n    MethodCall.prototype.evaluatedSuccessfully = function () {\n        this._evaluatedSuccessfully = true;\n    };\n    MethodCall.prototype.matches = function (call) {\n        var match = false;\n        if (this._setupCall.property && call && call.property &&\n            this._setupCall.property.name === call.property.name) {\n            if (this._setupCall.args.length >= call.args.length) {\n                match = true;\n                if (!call.isAnUnknownDynamicCallAtExecution) {\n                    _.each(this._setupCall.args, function (x, index) {\n                        var setupArg = x;\n                        var callArg = call.args[index];\n                        if (match && !setupArg.___matches(callArg))\n                            match = false;\n                    });\n                }\n            }\n        }\n        return match;\n    };\n    MethodCall.prototype.execute = function (call) {\n        this._isInvoked = true;\n        if (this._setupCallback != null) {\n            this._setupCallback.apply(this, call.args);\n        }\n        if (this._thrownException != null) {\n            throw this._thrownException;\n        }\n        this._callCount++;\n    };\n    MethodCall.prototype.verifiable = function (times, expectedCallType) {\n        this.setVerifiable(times, expectedCallType);\n    };\n    MethodCall.prototype.toString = function () {\n        var res = \"\" + this.setupCall;\n        if (this.expectedCallCount)\n            res = res + \", \" + this.expectedCallCount;\n        return res;\n    };\n    return MethodCall;\n}());\n\nvar __extends$4 = (undefined && undefined.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar MethodCallReturn = (function (_super) {\n    __extends$4(MethodCallReturn, _super);\n    function MethodCallReturn(mock, setupExpression, interceptor, proxy) {\n        var _this = _super.call(this, mock, setupExpression, interceptor, proxy) || this;\n        _this._overrideTarget = mock.canOverrideTarget;\n        return _this;\n    }\n    MethodCallReturn.ofStaticMock = function (mock, setupExpression) {\n        var interceptor = new InterceptorSetup();\n        var proxy = ProxyFactory.createProxy(mock.target, interceptor);\n        var result = new MethodCallReturn(mock, setupExpression, interceptor, proxy);\n        return result;\n    };\n    MethodCallReturn.ofDynamicMock = function (mock, setupExpression) {\n        var interceptor = new InterceptorSetup();\n        var proxy = ProxyFactory.createProxyES6(mock.target, interceptor);\n        var result = new MethodCallReturn(mock, setupExpression, interceptor, proxy);\n        return result;\n    };\n    MethodCallReturn.prototype.execute = function (call) {\n        _super.prototype.execute.call(this, call);\n        if (this._callBase)\n            call.invokeBase();\n        else if (this.hasReturnValue) {\n            call.returnValue = this._returnValueFunc.apply(this, call.args);\n            call.property.desc = { value: this.setupCall.property.desc && this.setupCall.property.desc.value };\n        }\n    };\n    MethodCallReturn.prototype.callback = function (action) {\n        this._setupCallback = action;\n        return this;\n    };\n    MethodCallReturn.prototype.throws = function (exception) {\n        this._thrownException = exception;\n        return this;\n    };\n    MethodCallReturn.prototype.returns = function (valueFunc) {\n        this._returnValueFunc = valueFunc;\n        this.hasReturnValue = true;\n        if (this._overrideTarget) {\n            var obj = this.mock.target;\n            var name_1 = this.setupCall.property.name;\n            var desc = this.setupCall.property.desc;\n            if (!desc &&\n                this.setupCall.proxyType == ProxyType.DYNAMIC) {\n                desc = {};\n                desc.configurable = true;\n                desc.enumerable = true;\n                if (this.setupCall.callType == CallType.FUNCTION)\n                    desc.value = this._returnValueFunc;\n                else\n                    desc.get = this._returnValueFunc;\n                Object.defineProperty(obj, name_1, desc);\n            }\n            else if (desc) {\n                desc.configurable = true;\n                desc.enumerable = true;\n                desc.value = this._returnValueFunc;\n                Object.defineProperty(obj, name_1, desc);\n            }\n        }\n        return this;\n    };\n    MethodCallReturn.prototype.callBase = function () {\n        this._callBase = true;\n        return this;\n    };\n    return MethodCallReturn;\n}(MethodCall));\n\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar StaticMock = (function (_super) {\n    __extends(StaticMock, _super);\n    function StaticMock(target, canOverrideTarget, behavior) {\n        var _this = _super.call(this, target, canOverrideTarget, behavior) || this;\n        _this._interceptor = new InterceptorExecute(_this);\n        _this._proxy = ProxyFactory.createProxy(target, _this._interceptor);\n        return _this;\n    }\n    StaticMock.ofInstance = function (targetInstance, behavior, shouldOverrideTarget) {\n        targetInstance = StaticMock.cloneDeep(targetInstance);\n        var mock = new StaticMock(targetInstance, shouldOverrideTarget, behavior);\n        return mock;\n    };\n    StaticMock.ofGlobalInstance = function (targetInstance, behavior) {\n        var mock = new StaticMock(targetInstance, false, behavior);\n        return mock;\n    };\n    StaticMock.ofType = function (targetConstructor, behavior, shouldOverrideTarget, targetConstructorArgs) {\n        var targetInstance = Utils.conthunktor(targetConstructor, targetConstructorArgs);\n        var mock = new StaticMock(targetInstance, shouldOverrideTarget, behavior);\n        return mock;\n    };\n    StaticMock.cloneDeep = function (target) {\n        var copy = target;\n        if (!_.isFunction(target)) {\n            var func = function (x) {\n                var value;\n                if (ProxyES5.isProxy(x))\n                    return x;\n            };\n            copy = _.cloneDeepWith(target, func);\n        }\n        return copy;\n    };\n    StaticMock.prototype.setup = function (expression) {\n        var call = MethodCallReturn.ofStaticMock(this, expression);\n        this._interceptor.addExpectedCall(call);\n        return call;\n    };\n    StaticMock.prototype.verify = function (expression, times) {\n        var call = MethodCall.ofStaticMock(this, expression);\n        this._interceptor.addExpectedCall(call);\n        try {\n            this._interceptor.verifyCallCount(call, times);\n        }\n        catch (e) {\n            throw e;\n        }\n    };\n    return StaticMock;\n}(MockBase));\n\nvar __extends$5 = (undefined && undefined.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar DynamicMock = (function (_super) {\n    __extends$5(DynamicMock, _super);\n    function DynamicMock(target, name, canOverrideTarget, behavior) {\n        var _this = _super.call(this, target, canOverrideTarget, behavior) || this;\n        if (name)\n            _this._name = name;\n        _this._interceptor = new InterceptorExecute(_this);\n        _this._proxy = ProxyFactory.createProxyES6(target, _this._interceptor);\n        return _this;\n    }\n    DynamicMock.ofType = function (name, behavior, shouldOverrideTarget) {\n        var mock = new DynamicMock((function () { }), name, shouldOverrideTarget, behavior);\n        return mock;\n    };\n    DynamicMock.prototype.setup = function (expression) {\n        var call = MethodCallReturn.ofDynamicMock(this, expression);\n        this._interceptor.addExpectedCall(call);\n        return call;\n    };\n    DynamicMock.prototype.verify = function (expression, times) {\n        var call = MethodCall.ofDynamicMock(this, expression);\n        this._interceptor.addExpectedCall(call);\n        try {\n            this._interceptor.verifyCallCount(call, times);\n        }\n        catch (e) {\n            throw e;\n        }\n    };\n    return DynamicMock;\n}(MockBase));\n\nvar MockApi = (function () {\n    function MockApi() {\n    }\n    MockApi.ofInstance = function (targetInstance, behavior, shouldOverrideTarget) {\n        if (behavior === void 0) { behavior = exports.MockBehavior.Loose; }\n        if (shouldOverrideTarget === void 0) { shouldOverrideTarget = true; }\n        var mock = StaticMock.ofInstance(targetInstance, behavior, shouldOverrideTarget);\n        return mock;\n    };\n    MockApi.ofType = function (targetConstructor, behavior, shouldOverrideTarget) {\n        if (behavior === void 0) { behavior = exports.MockBehavior.Loose; }\n        if (shouldOverrideTarget === void 0) { shouldOverrideTarget = true; }\n        var targetConstructorArgs = [];\n        for (var _i = 3; _i < arguments.length; _i++) {\n            targetConstructorArgs[_i - 3] = arguments[_i];\n        }\n        var mock;\n        if (targetConstructor)\n            mock = MockApi.ofType2(targetConstructor, targetConstructorArgs, behavior, shouldOverrideTarget);\n        else\n            mock = DynamicMock.ofType(undefined, behavior, shouldOverrideTarget);\n        return mock;\n    };\n    MockApi.ofType2 = function (targetConstructor, targetConstructorArgs, behavior, shouldOverrideTarget) {\n        if (behavior === void 0) { behavior = exports.MockBehavior.Loose; }\n        if (shouldOverrideTarget === void 0) { shouldOverrideTarget = true; }\n        var mock = StaticMock.ofType(targetConstructor, behavior, shouldOverrideTarget, targetConstructorArgs);\n        return mock;\n    };\n    return MockApi;\n}());\n\nvar It = (function () {\n    function It() {\n    }\n    It.isValue = function (x) {\n        var matcher = new MatchValue(x);\n        return matcher;\n    };\n    It.isObjectWith = function (x) {\n        var matcher = new MatchObjectWith(x);\n        return matcher;\n    };\n    It.isAnyObject = function (x) {\n        var matcher = new MatchAnyObject(x);\n        return matcher;\n    };\n    It.isAny = function () {\n        var matcher = new MatchAny();\n        return matcher;\n    };\n    It.isAnyString = function () {\n        var matcher = new MatchAnyString();\n        return matcher;\n    };\n    It.isAnyNumber = function () {\n        var matcher = new MatchAnyNumber();\n        return matcher;\n    };\n    It.is = function (predicate) {\n        var matcher = new MatchPred(predicate);\n        return matcher;\n    };\n    return It;\n}());\n\nvar GlobalType;\n(function (GlobalType) {\n    GlobalType[GlobalType[\"Class\"] = 0] = \"Class\";\n    GlobalType[GlobalType[\"Function\"] = 1] = \"Function\";\n    GlobalType[GlobalType[\"Value\"] = 2] = \"Value\";\n})(GlobalType || (GlobalType = {}));\nvar GlobalMock = (function () {\n    function GlobalMock(mock, _name, _type, container) {\n        this.mock = mock;\n        this._name = _name;\n        this._type = _type;\n        this.container = container;\n        if (!this._name)\n            this._name = mock.name;\n    }\n    Object.defineProperty(GlobalMock.prototype, \"object\", {\n        get: function () { return this.mock.object; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(GlobalMock.prototype, \"target\", {\n        get: function () { return this.mock.target; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(GlobalMock.prototype, \"name\", {\n        get: function () { return this._name || this.mock.name; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(GlobalMock.prototype, \"behavior\", {\n        get: function () { return this.mock.behavior; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(GlobalMock.prototype, \"callBase\", {\n        get: function () { return this.mock.callBase; },\n        set: function (value) { this.mock.callBase = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(GlobalMock.prototype, \"type\", {\n        get: function () { return this._type; },\n        enumerable: true,\n        configurable: true\n    });\n    GlobalMock.prototype.setup = function (expression) {\n        return this.mock.setup(expression);\n    };\n    GlobalMock.prototype.verify = function (expression, times) {\n        this.mock.verify(expression, times);\n    };\n    GlobalMock.prototype.verifyAll = function () {\n        this.mock.verifyAll();\n    };\n    GlobalMock.prototype.reset = function () {\n        this.mock.reset();\n    };\n    return GlobalMock;\n}());\n\nvar GlobalMockApi = (function () {\n    function GlobalMockApi() {\n    }\n    GlobalMockApi.ofInstance = function (targetInstance, globalName, container, behavior) {\n        if (container === void 0) { container = window; }\n        if (behavior === void 0) { behavior = exports.MockBehavior.Loose; }\n        var mock = StaticMock.ofGlobalInstance(targetInstance, behavior);\n        var type = _.isFunction(targetInstance) ? GlobalType.Function : GlobalType.Value;\n        return new GlobalMock(mock, globalName, type, container);\n    };\n    GlobalMockApi.ofType = function (targetConstructor, container, behavior) {\n        if (container === void 0) { container = window; }\n        if (behavior === void 0) { behavior = exports.MockBehavior.Loose; }\n        var targetInstance = new targetConstructor();\n        var mock = StaticMock.ofInstance(targetInstance, behavior, false);\n        return new GlobalMock(mock, undefined, GlobalType.Class, container);\n    };\n    GlobalMockApi.ofType2 = function (globalName, container, behavior) {\n        if (container === void 0) { container = window; }\n        if (behavior === void 0) { behavior = exports.MockBehavior.Loose; }\n        var mock = DynamicMock.ofType(globalName, behavior, false);\n        return new GlobalMock(mock, undefined, GlobalType.Class, container);\n    };\n    return GlobalMockApi;\n}());\n\nvar GlobalScope = (function () {\n    function GlobalScope(_args) {\n        this._args = _args;\n    }\n    GlobalScope.prototype.with = function (action) {\n        var initial = {};\n        try {\n            _.each(this._args, function (a) {\n                var containerProps = PropertyRetriever.getOwnAndPrototypeEnumerablesAndNonenumerables(a.container);\n                var prop = _.find(containerProps, function (p) { return p.name === a.name; });\n                if (prop) {\n                    initial[a.name] = prop.desc;\n                    var desc = {};\n                    switch (a.type) {\n                        case GlobalType.Class:\n                            desc.value = function () { return a.mock.object; };\n                            break;\n                        case GlobalType.Function:\n                            desc.value = a.mock.object;\n                            break;\n                        case GlobalType.Value:\n                            desc.get = function () { return a.mock.object; };\n                            break;\n                        default:\n                            throw new MockException(MockExceptionReason.UnknownGlobalType, a, \"unknown global type: \" + a.type);\n                    }\n                    try {\n                        Object.defineProperty(a.container, a.name, desc);\n                    }\n                    catch (e) {\n                        console.log(\"1: \" + e);\n                    }\n                }\n            });\n            action.apply(this, this._args);\n        }\n        catch (e) {\n            console.log(\"2: \" + e);\n        }\n        finally {\n            _.each(this._args, function (a) {\n                var desc = initial[a.name];\n                if (desc) {\n                    switch (a.type) {\n                        case GlobalType.Class:\n                            break;\n                        case GlobalType.Function:\n                            break;\n                        case GlobalType.Value:\n                            desc.configurable = true;\n                            break;\n                        default:\n                    }\n                    try {\n                        Object.defineProperty(a.container, a.name, desc);\n                    }\n                    catch (e) {\n                        console.log(\"3: \" + e);\n                    }\n                }\n            });\n        }\n    };\n    return GlobalScope;\n}());\n\nvar GlobalScopeApi = (function () {\n    function GlobalScopeApi() {\n    }\n    GlobalScopeApi.using = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var scope = new GlobalScope(args);\n        return scope;\n    };\n    return GlobalScopeApi;\n}());\n\nexports.Mock = MockApi;\nexports.It = It;\nexports.Times = Times;\nexports.GlobalMock = GlobalMockApi;\nexports.GlobalScope = GlobalScopeApi;\nexports.MockException = MockException;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n\n//# sourceMappingURL=typemoq.js.map\n"]},"metadata":{},"sourceType":"script"}